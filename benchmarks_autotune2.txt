Running all 11 kernels...


============================================================
Kernel: vector_add
============================================================

Running vector_add benchmark with Helion implementation...

  0%|          | 0/16 [00:00<?, ?it/s]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
[9s] Initial population: failed=1 min=0.0046 mid=0.0051 max=0.0101 best=Config(block_sizes=[128], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[23s] Generation 2: replaced=7 min=0.0045 mid=0.0047 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[37s] Generation 3: replaced=11 min=0.0045 mid=0.0046 max=0.0050 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[51s] Generation 4: replaced=5 min=0.0045 mid=0.0046 max=0.0050 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[65s] Generation 5: replaced=7 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[77s] Generation 6: replaced=9 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[90s] Generation 7: replaced=3 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[103s] Generation 8: replaced=4 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[116s] Generation 9: replaced=0 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[127s] Generation 10: replaced=4 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[139s] Generation 11: replaced=3 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[152s] Generation 12: replaced=3 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[163s] Generation 13: replaced=3 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[175s] Generation 14: replaced=5 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[186s] Generation 15: replaced=4 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat')
[197s] Generation 16: replaced=1 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat')
[208s] Generation 17: replaced=2 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat')
[218s] Generation 18: replaced=6 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat')
[229s] Generation 19: replaced=2 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat')
[229s] Autotuning complete in 229.0s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='flat'))

  6%|▋         | 1/16 [03:49<57:24, 229.61s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.70ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 1 outliers from 848 samples
[10s] Initial population: min=0.0046 mid=0.0053 max=0.0214 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[24s] Generation 2: replaced=18 min=0.0046 mid=0.0049 max=0.0052 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[37s] Generation 3: replaced=15 min=0.0046 mid=0.0047 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[50s] Generation 4: replaced=8 min=0.0046 mid=0.0047 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[63s] Generation 5: replaced=6 min=0.0046 mid=0.0047 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[77s] Generation 6: replaced=5 min=0.0046 mid=0.0046 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[90s] Generation 7: replaced=7 min=0.0046 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[103s] Generation 8: replaced=3 min=0.0046 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[116s] Generation 9: replaced=2 min=0.0046 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[129s] Generation 10: replaced=2 min=0.0046 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[142s] Generation 11: replaced=1 min=0.0046 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[154s] Generation 12: replaced=3 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[167s] Generation 13: replaced=3 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[179s] Generation 14: replaced=2 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[190s] Generation 15: replaced=2 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[201s] Generation 16: replaced=2 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[212s] Generation 17: replaced=2 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[224s] Generation 18: replaced=3 min=0.0046 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[235s] Generation 19: replaced=2 min=0.0046 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[235s] Autotuning complete in 235.5s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 12%|█▎        | 2/16 [07:45<54:25, 233.28s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 4.19ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
[12s] Initial population: failed=5 min=0.0047 mid=0.0057 max=0.0478 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[25s] Generation 2: replaced=19 min=0.0047 mid=0.0049 max=0.0057 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[41s] Generation 3: replaced=11 min=0.0047 mid=0.0048 max=0.0057 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[54s] Generation 4: replaced=9 min=0.0047 mid=0.0048 max=0.0052 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[68s] Generation 5: replaced=10 min=0.0047 mid=0.0048 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[83s] Generation 6: replaced=4 min=0.0047 mid=0.0048 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[97s] Generation 7: replaced=5 min=0.0047 mid=0.0047 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[110s] Generation 8: replaced=6 min=0.0047 mid=0.0047 max=0.0050 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[122s] Generation 9: replaced=4 min=0.0047 mid=0.0047 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[134s] Generation 10: replaced=2 min=0.0047 mid=0.0047 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[145s] Generation 11: replaced=5 min=0.0047 mid=0.0047 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[157s] Generation 12: replaced=4 min=0.0047 mid=0.0047 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[168s] Generation 13: replaced=2 min=0.0047 mid=0.0047 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[179s] Generation 14: replaced=2 min=0.0047 mid=0.0047 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[190s] Generation 15: replaced=3 min=0.0047 mid=0.0047 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[202s] Generation 16: replaced=2 min=0.0047 mid=0.0047 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[213s] Generation 17: replaced=1 min=0.0047 mid=0.0047 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[224s] Generation 18: replaced=4 min=0.0047 mid=0.0047 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[235s] Generation 19: replaced=1 min=0.0047 mid=0.0047 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[235s] Autotuning complete in 235.6s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 19%|█▉        | 3/16 [11:41<50:48, 234.48s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 3.31ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 4 outliers from 798 samples
Removed 2 outliers from 847 samples
Removed 5 outliers from 829 samples
[29s] Initial population: failed=3 min=0.0048 mid=0.0061 max=0.0982 best=Config(block_sizes=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[44s] Generation 2: replaced=19 min=0.0048 mid=0.0050 max=0.0058 best=Config(block_sizes=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[58s] Generation 3: replaced=13 min=0.0048 mid=0.0049 max=0.0056 best=Config(block_sizes=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[72s] Generation 4: replaced=17 min=0.0048 mid=0.0049 max=0.0055 best=Config(block_sizes=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[87s] Generation 5: replaced=5 min=0.0048 mid=0.0049 max=0.0055 best=Config(block_sizes=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[101s] Generation 6: replaced=6 min=0.0048 mid=0.0048 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[115s] Generation 7: replaced=3 min=0.0048 mid=0.0048 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[129s] Generation 8: replaced=5 min=0.0048 mid=0.0048 max=0.0052 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[142s] Generation 9: replaced=6 min=0.0048 mid=0.0048 max=0.0050 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[154s] Generation 10: replaced=4 min=0.0048 mid=0.0048 max=0.0050 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[165s] Generation 11: replaced=6 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[176s] Generation 12: replaced=3 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[187s] Generation 13: replaced=1 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[197s] Generation 14: replaced=1 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[208s] Generation 15: replaced=4 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat')
[219s] Generation 16: replaced=1 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat')
[229s] Generation 17: replaced=1 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat')
[240s] Generation 18: replaced=2 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat')
[251s] Generation 19: replaced=0 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat')
[251s] Autotuning complete in 251.3s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat'))

 25%|██▌       | 4/16 [15:53<48:15, 241.26s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.49ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 2 outliers from 821 samples
Removed 4 outliers from 845 samples
Removed 7 outliers from 836 samples
[10s] Initial population: failed=7 min=0.0050 mid=0.0066 max=0.4514 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[26s] Generation 2: replaced=17 min=0.0050 mid=0.0053 max=0.0067 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[41s] Generation 3: replaced=13 min=0.0050 mid=0.0053 max=0.0059 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[56s] Generation 4: replaced=15 min=0.0049 mid=0.0051 max=0.0057 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[70s] Generation 5: replaced=10 min=0.0049 mid=0.0050 max=0.0054 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[85s] Generation 6: replaced=8 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[100s] Generation 7: replaced=2 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[113s] Generation 8: replaced=3 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[126s] Generation 9: replaced=8 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[139s] Generation 10: replaced=3 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[152s] Generation 11: replaced=3 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[164s] Generation 12: replaced=3 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[176s] Generation 13: replaced=1 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[189s] Generation 14: replaced=0 min=0.0049 mid=0.0050 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[201s] Generation 15: replaced=2 min=0.0049 mid=0.0050 max=0.0052 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[214s] Generation 16: replaced=2 min=0.0049 mid=0.0050 max=0.0052 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[228s] Generation 17: replaced=0 min=0.0049 mid=0.0050 max=0.0052 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[240s] Generation 18: replaced=1 min=0.0049 mid=0.0050 max=0.0052 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[252s] Generation 19: replaced=2 min=0.0049 mid=0.0050 max=0.0051 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[252s] Autotuning complete in 252.7s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 31%|███▏      | 5/16 [20:06<45:00, 245.51s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 3.26ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 3 outliers from 848 samples
Removed 6 outliers from 838 samples
[10s] Initial population: failed=1 min=0.0055 mid=0.0079 max=0.3764 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[27s] Generation 2: replaced=21 min=0.0054 mid=0.0059 max=0.0074 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[42s] Generation 3: replaced=17 min=0.0054 mid=0.0057 max=0.0064 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[54s] Generation 4: replaced=13 min=0.0054 mid=0.0056 max=0.0060 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[67s] Generation 5: replaced=9 min=0.0054 mid=0.0056 max=0.0059 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[79s] Generation 6: replaced=7 min=0.0054 mid=0.0056 max=0.0059 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[90s] Generation 7: replaced=10 min=0.0054 mid=0.0055 max=0.0059 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[101s] Generation 8: replaced=5 min=0.0054 mid=0.0055 max=0.0059 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[112s] Generation 9: replaced=5 min=0.0054 mid=0.0055 max=0.0059 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[123s] Generation 10: replaced=5 min=0.0054 mid=0.0055 max=0.0059 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[134s] Generation 11: replaced=4 min=0.0054 mid=0.0055 max=0.0056 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[145s] Generation 12: replaced=5 min=0.0054 mid=0.0055 max=0.0056 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[156s] Generation 13: replaced=4 min=0.0054 mid=0.0055 max=0.0056 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[166s] Generation 14: replaced=7 min=0.0054 mid=0.0055 max=0.0056 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[177s] Generation 15: replaced=3 min=0.0054 mid=0.0055 max=0.0056 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[188s] Generation 16: replaced=7 min=0.0054 mid=0.0055 max=0.0055 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[199s] Generation 17: replaced=1 min=0.0054 mid=0.0055 max=0.0055 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[210s] Generation 18: replaced=1 min=0.0054 mid=0.0055 max=0.0055 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[220s] Generation 19: replaced=0 min=0.0054 mid=0.0055 max=0.0055 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[220s] Autotuning complete in 220.9s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 38%|███▊      | 6/16 [23:47<39:32, 237.27s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.09ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 1 outliers from 835 samples
[12s] Initial population: failed=6 min=0.0065 mid=0.0097 max=0.5381 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[34s] Generation 2: replaced=17 min=0.0065 mid=0.0072 max=0.0092 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[51s] Generation 3: replaced=8 min=0.0065 mid=0.0070 max=0.0080 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[67s] Generation 4: replaced=12 min=0.0065 mid=0.0069 max=0.0078 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[84s] Generation 5: replaced=6 min=0.0065 mid=0.0069 max=0.0073 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[101s] Generation 6: replaced=12 min=0.0065 mid=0.0067 max=0.0073 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[119s] Generation 7: replaced=9 min=0.0065 mid=0.0067 max=0.0072 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[135s] Generation 8: replaced=6 min=0.0065 mid=0.0066 max=0.0072 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[151s] Generation 9: replaced=6 min=0.0065 mid=0.0066 max=0.0072 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[166s] Generation 10: replaced=2 min=0.0065 mid=0.0066 max=0.0072 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[183s] Generation 11: replaced=3 min=0.0065 mid=0.0066 max=0.0070 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[200s] Generation 12: replaced=5 min=0.0065 mid=0.0066 max=0.0070 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[214s] Generation 13: replaced=6 min=0.0065 mid=0.0066 max=0.0070 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[229s] Generation 14: replaced=5 min=0.0065 mid=0.0066 max=0.0070 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[243s] Generation 15: replaced=5 min=0.0065 mid=0.0066 max=0.0070 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[257s] Generation 16: replaced=4 min=0.0065 mid=0.0066 max=0.0068 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[270s] Generation 17: replaced=2 min=0.0065 mid=0.0066 max=0.0067 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[284s] Generation 18: replaced=1 min=0.0065 mid=0.0066 max=0.0067 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[298s] Generation 19: replaced=0 min=0.0065 mid=0.0066 max=0.0067 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[298s] Autotuning complete in 298.2s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 44%|████▍     | 7/16 [28:45<38:35, 257.31s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 3.38ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
[61s] Timeout after 60s compiling Config(block_sizes=[262144], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[True], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='persistent_blocked')
[61s] Timeout after 60s compiling Config(block_sizes=[262144], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[False], num_warps=4, num_stages=6, indexing='tensor_descriptor', pid_type='persistent_blocked')
[70s] Initial population: failed=5 min=0.0080 mid=0.0111 max=0.8546 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[101s] Generation 2: replaced=17 min=0.0080 mid=0.0085 max=0.0111 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[118s] Generation 3: replaced=20 min=0.0079 mid=0.0082 max=0.0094 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[136s] Generation 4: replaced=7 min=0.0079 mid=0.0082 max=0.0094 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[152s] Generation 5: replaced=9 min=0.0079 mid=0.0081 max=0.0088 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[170s] Generation 6: replaced=6 min=0.0079 mid=0.0081 max=0.0086 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[185s] Generation 7: replaced=9 min=0.0079 mid=0.0081 max=0.0086 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[208s] Generation 8: replaced=8 min=0.0079 mid=0.0080 max=0.0084 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[222s] Generation 9: replaced=1 min=0.0079 mid=0.0080 max=0.0084 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[237s] Generation 10: replaced=4 min=0.0079 mid=0.0080 max=0.0084 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[251s] Generation 11: replaced=5 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[265s] Generation 12: replaced=1 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[279s] Generation 13: replaced=2 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[294s] Generation 14: replaced=1 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[307s] Generation 15: replaced=2 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[322s] Generation 16: replaced=7 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=5, indexing='block_ptr', pid_type='flat')
[335s] Generation 17: replaced=4 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat')
[347s] Generation 18: replaced=2 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat')
[359s] Generation 19: replaced=1 min=0.0079 mid=0.0080 max=0.0082 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat')
[359s] Autotuning complete in 359.9s after searching 1518 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat'))

 50%|█████     | 8/16 [34:46<38:40, 290.09s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 3.43ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 10 outliers from 822 samples
[60s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[True], num_warps=2, num_stages=4, indexing='block_ptr', pid_type='persistent_interleaved')
[68s] Initial population: failed=9 min=0.0111 mid=0.0169 max=0.6551 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[140s] Generation 2: replaced=20 min=0.0111 mid=0.0118 max=0.0194 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[227s] Generation 3: replaced=11 min=0.0110 mid=0.0116 max=0.0155 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[252s] Generation 4: replaced=9 min=0.0110 mid=0.0115 max=0.0155 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[302s] Generation 5: replaced=8 min=0.0109 mid=0.0113 max=0.0134 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[322s] Generation 6: replaced=12 min=0.0108 mid=0.0112 max=0.0132 best=Config(block_sizes=[8192], range_unroll_factors=[4], range_num_stages=[1], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=1, indexing='pointer', pid_type='persistent_blocked')
[343s] Generation 7: replaced=13 min=0.0108 mid=0.0112 max=0.0132 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[362s] Generation 8: replaced=10 min=0.0108 mid=0.0111 max=0.0127 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[380s] Generation 9: replaced=5 min=0.0108 mid=0.0111 max=0.0122 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[403s] Generation 10: replaced=7 min=0.0108 mid=0.0111 max=0.0116 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[423s] Generation 11: replaced=5 min=0.0108 mid=0.0111 max=0.0115 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[453s] Generation 12: replaced=7 min=0.0108 mid=0.0111 max=0.0115 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[468s] Generation 13: replaced=3 min=0.0108 mid=0.0111 max=0.0115 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[483s] Generation 14: replaced=3 min=0.0108 mid=0.0111 max=0.0115 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[497s] Generation 15: replaced=4 min=0.0108 mid=0.0110 max=0.0114 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[512s] Generation 16: replaced=1 min=0.0108 mid=0.0110 max=0.0114 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[525s] Generation 17: replaced=5 min=0.0108 mid=0.0110 max=0.0113 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[538s] Generation 18: replaced=3 min=0.0108 mid=0.0110 max=0.0112 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[551s] Generation 19: replaced=1 min=0.0108 mid=0.0110 max=0.0112 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[551s] Autotuning complete in 551.8s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 56%|█████▋    | 9/16 [43:58<43:24, 372.02s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 3.53ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 6 outliers from 792 samples
Removed 8 outliers from 775 samples
Process ForkProcess-13702:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 1654, in arange
    return _semantic.arange(start, end)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 586, in arange
    ret_ty = tl.block_type(tl.int32, shape)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (2097152) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 4:28:
def _add_kernel(x, y, out, x_size_0, out_stride_0, x_stride_0, y_stride_0, _BLOCK_SIZE_0: tl.constexpr):
    pid_0 = tl.program_id(0)
    offset_0 = pid_0 * _BLOCK_SIZE_0
    indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
                            ^
[62s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[2], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=5, indexing='tensor_descriptor', pid_type='persistent_blocked')
[70s] Initial population: failed=11 min=0.0166 mid=0.0250 max=1.6938 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[103s] Generation 2: replaced=17 min=0.0166 mid=0.0180 max=0.0309 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[120s] Generation 3: replaced=12 min=0.0166 mid=0.0178 max=0.0247 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[138s] Generation 4: replaced=14 min=0.0163 mid=0.0172 max=0.0247 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[162s] Generation 5: replaced=12 min=0.0163 mid=0.0170 max=0.0247 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[177s] Generation 6: replaced=14 min=0.0163 mid=0.0169 max=0.0175 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[192s] Generation 7: replaced=7 min=0.0163 mid=0.0167 max=0.0173 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[208s] Generation 8: replaced=11 min=0.0163 mid=0.0167 max=0.0173 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[227s] Generation 9: replaced=8 min=0.0163 mid=0.0167 max=0.0172 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[244s] Generation 10: replaced=5 min=0.0163 mid=0.0167 max=0.0172 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[259s] Generation 11: replaced=4 min=0.0163 mid=0.0167 max=0.0172 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[275s] Generation 12: replaced=4 min=0.0163 mid=0.0166 max=0.0172 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[289s] Generation 13: replaced=5 min=0.0163 mid=0.0166 max=0.0171 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[301s] Generation 14: replaced=8 min=0.0163 mid=0.0166 max=0.0170 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[314s] Generation 15: replaced=5 min=0.0163 mid=0.0165 max=0.0170 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[328s] Generation 16: replaced=4 min=0.0163 mid=0.0165 max=0.0170 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[341s] Generation 17: replaced=6 min=0.0163 mid=0.0165 max=0.0167 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[354s] Generation 18: replaced=1 min=0.0163 mid=0.0165 max=0.0167 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[368s] Generation 19: replaced=5 min=0.0163 mid=0.0165 max=0.0167 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[368s] Autotuning complete in 368.1s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 62%|██████▎   | 10/16 [50:06<37:05, 370.91s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 3.53ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 7 outliers from 769 samples
Removed 14 outliers from 709 samples
Removed 5 outliers from 708 samples
[60s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[0], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='persistent_blocked')
[69s] Initial population: failed=9 min=0.0275 mid=0.0693 max=10.9824 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[123s] Generation 2: replaced=22 min=0.0275 mid=0.0293 max=0.0690 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[153s] Generation 3: replaced=10 min=0.0275 mid=0.0290 max=0.0326 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[192s] Generation 4: replaced=13 min=0.0275 mid=0.0287 max=0.0326 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[212s] Generation 5: replaced=17 min=0.0269 mid=0.0284 max=0.0303 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[230s] Generation 6: replaced=11 min=0.0269 mid=0.0281 max=0.0292 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[246s] Generation 7: replaced=8 min=0.0269 mid=0.0280 max=0.0289 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[261s] Generation 8: replaced=11 min=0.0269 mid=0.0278 max=0.0288 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[274s] Generation 9: replaced=15 min=0.0269 mid=0.0278 max=0.0285 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[291s] Generation 10: replaced=9 min=0.0269 mid=0.0276 max=0.0285 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[305s] Generation 11: replaced=13 min=0.0269 mid=0.0276 max=0.0285 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[320s] Generation 12: replaced=7 min=0.0269 mid=0.0275 max=0.0279 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[333s] Generation 13: replaced=8 min=0.0269 mid=0.0275 max=0.0279 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[347s] Generation 14: replaced=6 min=0.0269 mid=0.0275 max=0.0279 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat')
[359s] Generation 15: replaced=6 min=0.0269 mid=0.0274 max=0.0277 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat')
[372s] Generation 16: replaced=3 min=0.0269 mid=0.0274 max=0.0277 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat')
[384s] Generation 17: replaced=5 min=0.0269 mid=0.0274 max=0.0277 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat')
[396s] Generation 18: replaced=4 min=0.0269 mid=0.0273 max=0.0277 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat')
[409s] Generation 19: replaced=5 min=0.0269 mid=0.0273 max=0.0276 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='block_ptr', pid_type='flat')
[409s] Autotuning complete in 409.0s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='block_ptr', pid_type='flat'))

 69%|██████▉   | 11/16 [56:56<31:53, 382.68s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.47ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 13 outliers from 714 samples
Removed 27 outliers from 613 samples
Removed 18 outliers from 608 samples
[62s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[True], range_flattens=[False], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='persistent_blocked')
[71s] Initial population: failed=5 min=0.0504 mid=0.0833 max=20.4362 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[99s] Generation 2: replaced=17 min=0.0504 mid=0.0527 max=0.0833 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[135s] Generation 3: replaced=14 min=0.0504 mid=0.0519 max=0.0589 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[161s] Generation 4: replaced=16 min=0.0502 mid=0.0517 max=0.0583 best=Config(block_sizes=[32768], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[189s] Generation 5: replaced=11 min=0.0502 mid=0.0513 max=0.0583 best=Config(block_sizes=[32768], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[235s] Generation 6: replaced=14 min=0.0502 mid=0.0510 max=0.0527 best=Config(block_sizes=[32768], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[267s] Generation 7: replaced=16 min=0.0501 mid=0.0508 max=0.0527 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='block_ptr', pid_type='flat')
[300s] Generation 8: replaced=15 min=0.0501 mid=0.0506 max=0.0527 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat')
[316s] Generation 9: replaced=8 min=0.0501 mid=0.0506 max=0.0520 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat')
[329s] Generation 10: replaced=9 min=0.0501 mid=0.0505 max=0.0509 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat')
[342s] Generation 11: replaced=6 min=0.0501 mid=0.0504 max=0.0509 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat')
[356s] Generation 12: replaced=6 min=0.0501 mid=0.0504 max=0.0509 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat')
[384s] Generation 13: replaced=5 min=0.0501 mid=0.0504 max=0.0508 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='flat')
[397s] Generation 14: replaced=2 min=0.0501 mid=0.0504 max=0.0508 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='flat')
[410s] Generation 15: replaced=2 min=0.0501 mid=0.0504 max=0.0508 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='flat')
[423s] Generation 16: replaced=3 min=0.0501 mid=0.0504 max=0.0508 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='flat')
[436s] Generation 17: replaced=6 min=0.0501 mid=0.0503 max=0.0507 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='flat')
[448s] Generation 18: replaced=4 min=0.0501 mid=0.0503 max=0.0507 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='flat')
[461s] Generation 19: replaced=4 min=0.0501 mid=0.0503 max=0.0506 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='block_ptr', pid_type='flat')
[461s] Autotuning complete in 461.1s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='block_ptr', pid_type='flat'))

 75%|███████▌  | 12/16 [1:04:37<27:06, 406.65s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.35ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 19 outliers from 608 samples
[61s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[3], range_num_stages=[4], range_multi_buffers=[True], range_flattens=[False], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved')
[61s] Timeout after 60s compiling Config(block_sizes=[524288], range_unroll_factors=[4], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=16, num_stages=1, indexing='tensor_descriptor', pid_type='persistent_blocked')
[62s] Timeout after 60s compiling Config(block_sizes=[524288], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[False], num_warps=16, num_stages=1, indexing='pointer', pid_type='persistent_blocked')
[72s] Initial population: failed=11 min=0.0950 mid=0.1438 max=46.3819 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[102s] Generation 2: replaced=14 min=0.0946 mid=0.0977 max=0.1525 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[127s] Generation 3: replaced=10 min=0.0946 mid=0.0974 max=0.1525 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[150s] Generation 4: replaced=14 min=0.0946 mid=0.0971 max=0.1193 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[173s] Generation 5: replaced=16 min=0.0946 mid=0.0964 max=0.1051 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[209s] Generation 6: replaced=10 min=0.0946 mid=0.0964 max=0.1051 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[239s] Generation 7: replaced=11 min=0.0946 mid=0.0962 max=0.1006 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[255s] Generation 8: replaced=13 min=0.0946 mid=0.0958 max=0.0997 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[271s] Generation 9: replaced=15 min=0.0945 mid=0.0954 max=0.0971 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[284s] Generation 10: replaced=10 min=0.0945 mid=0.0951 max=0.0971 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[301s] Generation 11: replaced=12 min=0.0945 mid=0.0950 max=0.0966 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[315s] Generation 12: replaced=13 min=0.0945 mid=0.0950 max=0.0962 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[329s] Generation 13: replaced=11 min=0.0945 mid=0.0950 max=0.0956 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[346s] Generation 14: replaced=8 min=0.0945 mid=0.0946 max=0.0956 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[361s] Generation 15: replaced=9 min=0.0945 mid=0.0946 max=0.0956 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[375s] Generation 16: replaced=6 min=0.0945 mid=0.0946 max=0.0956 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[388s] Generation 17: replaced=7 min=0.0945 mid=0.0946 max=0.0950 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[402s] Generation 18: replaced=7 min=0.0945 mid=0.0946 max=0.0950 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[415s] Generation 19: replaced=8 min=0.0945 mid=0.0946 max=0.0950 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat')
[415s] Autotuning complete in 415.8s after searching 1517 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat'))

 81%|████████▏ | 13/16 [1:11:33<20:28, 409.53s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.33ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 18 outliers from 469 samples
Removed 2 outliers from 333 samples
Removed 2 outliers from 330 samples
Process ForkProcess-19804:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 1654, in arange
    return _semantic.arange(start, end)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 586, in arange
    ret_ty = tl.block_type(tl.int32, shape)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (2097152) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 6:32:
def _add_kernel(x, y, out, x_size_0, out_stride_0, x_stride_0, y_stride_0, _NUM_SM: tl.constexpr, _BLOCK_SIZE_0: tl.constexpr):
    total_pids = tl.cdiv(x_size_0, _BLOCK_SIZE_0)
    for virtual_pid in tl.range(tl.program_id(0), total_pids, _NUM_SM, loop_unroll_factor=4, num_stages=3):
        pid_0 = virtual_pid
        offset_0 = pid_0 * _BLOCK_SIZE_0
        indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
                                ^
[61s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=7, indexing='tensor_descriptor', pid_type='persistent_blocked')
[61s] Timeout after 61s compiling Config(block_sizes=[262144], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[True], num_warps=8, num_stages=2, indexing='pointer', pid_type='persistent_blocked')
[62s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=1, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[63s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[0], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[False], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[74s] Initial population: failed=13 min=0.1861 mid=0.3203 max=95.4052 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[122s] Generation 2: replaced=21 min=0.1861 mid=0.1887 max=0.3844 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[144s] Generation 3: replaced=12 min=0.1861 mid=0.1881 max=0.3001 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[182s] Generation 4: replaced=12 min=0.1861 mid=0.1873 max=0.2384 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[199s] Generation 5: replaced=15 min=0.1860 mid=0.1870 max=0.2259 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[215s] Generation 6: replaced=13 min=0.1860 mid=0.1868 max=0.1885 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[234s] Generation 7: replaced=17 min=0.1860 mid=0.1865 max=0.1881 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[249s] Generation 8: replaced=14 min=0.1860 mid=0.1862 max=0.1881 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[262s] Generation 9: replaced=11 min=0.1860 mid=0.1862 max=0.1881 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[276s] Generation 10: replaced=8 min=0.1860 mid=0.1861 max=0.1869 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='tensor_descriptor', pid_type='flat')
[290s] Generation 11: replaced=10 min=0.1860 mid=0.1861 max=0.1869 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='tensor_descriptor', pid_type='flat')
[304s] Generation 12: replaced=4 min=0.1860 mid=0.1861 max=0.1868 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='tensor_descriptor', pid_type='flat')
[318s] Generation 13: replaced=12 min=0.1860 mid=0.1860 max=0.1865 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[331s] Generation 14: replaced=6 min=0.1860 mid=0.1860 max=0.1865 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[345s] Generation 15: replaced=10 min=0.1860 mid=0.1860 max=0.1861 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[359s] Generation 16: replaced=5 min=0.1860 mid=0.1860 max=0.1861 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[373s] Generation 17: replaced=5 min=0.1860 mid=0.1860 max=0.1861 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[387s] Generation 18: replaced=2 min=0.1860 mid=0.1860 max=0.1861 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[401s] Generation 19: replaced=3 min=0.1860 mid=0.1860 max=0.1861 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[401s] Autotuning complete in 401.8s after searching 1516 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat'))

 88%|████████▊ | 14/16 [1:18:15<13:34, 407.29s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.05ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 3 outliers from 333 samples
Removed 1 outliers from 208 samples
Removed 1 outliers from 206 samples
Process ForkProcess-21308:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 1654, in arange
    return _semantic.arange(start, end)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 586, in arange
    ret_ty = tl.block_type(tl.int32, shape)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (2097152) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 4:28:
def _add_kernel(x, y, out, x_size_0, out_stride_0, x_stride_0, y_stride_0, _BLOCK_SIZE_0: tl.constexpr):
    pid_0 = tl.program_id(0)
    offset_0 = pid_0 * _BLOCK_SIZE_0
    indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
                            ^
[63s] Timeout after 60s compiling Config(block_sizes=[524288], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[False], num_warps=8, num_stages=7, indexing='pointer', pid_type='persistent_blocked')
[78s] Initial population: failed=10 min=0.3638 mid=0.7400 max=170.9509 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[139s] Timeout after 60s compiling Config(block_sizes=[1048576], range_unroll_factors=[3], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='persistent_interleaved')
[139s] Timeout after 60s compiling Config(block_sizes=[262144], range_unroll_factors=[3], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[True], num_warps=4, num_stages=2, indexing='pointer', pid_type='persistent_interleaved')
[161s] Generation 2: replaced=16 min=0.3638 mid=0.3809 max=1.0678 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[183s] Generation 3: replaced=16 min=0.3638 mid=0.3717 max=1.0678 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[203s] Generation 4: replaced=16 min=0.3638 mid=0.3675 max=1.0678 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[226s] Generation 5: replaced=11 min=0.3618 mid=0.3656 max=0.3804 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[260s] Generation 6: replaced=10 min=0.3618 mid=0.3644 max=0.3748 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[274s] Generation 7: replaced=12 min=0.3618 mid=0.3644 max=0.3698 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[290s] Generation 8: replaced=15 min=0.3618 mid=0.3640 max=0.3676 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[304s] Generation 9: replaced=7 min=0.3617 mid=0.3640 max=0.3669 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[319s] Generation 10: replaced=6 min=0.3617 mid=0.3639 max=0.3669 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[333s] Generation 11: replaced=12 min=0.3617 mid=0.3629 max=0.3652 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[348s] Generation 12: replaced=12 min=0.3617 mid=0.3627 max=0.3652 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[363s] Generation 13: replaced=15 min=0.3617 mid=0.3624 max=0.3640 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[377s] Generation 14: replaced=10 min=0.3617 mid=0.3624 max=0.3640 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[392s] Generation 15: replaced=11 min=0.3617 mid=0.3623 max=0.3640 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[406s] Generation 16: replaced=12 min=0.3616 mid=0.3622 max=0.3639 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=1, indexing='tensor_descriptor', pid_type='flat')
[421s] Generation 17: replaced=11 min=0.3616 mid=0.3620 max=0.3627 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=1, indexing='tensor_descriptor', pid_type='flat')
[436s] Generation 18: replaced=6 min=0.3616 mid=0.3620 max=0.3627 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=1, indexing='tensor_descriptor', pid_type='flat')
[451s] Generation 19: replaced=8 min=0.3616 mid=0.3617 max=0.3624 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='tensor_descriptor', pid_type='flat')
[451s] Autotuning complete in 451.6s after searching 1517 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='tensor_descriptor', pid_type='flat'))

 94%|█████████▍| 15/16 [1:25:47<07:00, 420.77s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_add
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for triton_add
INFO:tritonbench.utils.triton_op:Took 2.26ms to get benchmark function for helion_vector_add
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 7 outliers from 210 samples
Removed 3 outliers from 118 samples
[63s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=1, num_stages=6, indexing='block_ptr', pid_type='persistent_blocked')
[80s] Initial population: failed=6 min=0.7231 mid=1.7485 max=202.4569 best=Config(block_sizes=[32768], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[101s] Generation 2: replaced=21 min=0.7172 mid=0.7512 max=1.6729 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[123s] Generation 3: replaced=21 min=0.7156 mid=0.7317 max=1.6729 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[147s] Generation 4: replaced=19 min=0.7156 mid=0.7268 max=0.8966 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[166s] Generation 5: replaced=15 min=0.7156 mid=0.7216 max=0.7419 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[188s] Generation 6: replaced=13 min=0.7154 mid=0.7202 max=0.7419 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[205s] Generation 7: replaced=17 min=0.7154 mid=0.7199 max=0.7419 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[222s] Generation 8: replaced=8 min=0.7154 mid=0.7178 max=0.7419 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[241s] Generation 9: replaced=10 min=0.7154 mid=0.7173 max=0.7419 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[258s] Generation 10: replaced=15 min=0.7154 mid=0.7171 max=0.7340 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[274s] Generation 11: replaced=10 min=0.7154 mid=0.7159 max=0.7340 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[291s] Generation 12: replaced=10 min=0.7154 mid=0.7158 max=0.7340 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat')
[307s] Generation 13: replaced=9 min=0.7154 mid=0.7157 max=0.7202 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat')
[324s] Generation 14: replaced=13 min=0.7154 mid=0.7156 max=0.7175 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[341s] Generation 15: replaced=15 min=0.7154 mid=0.7156 max=0.7170 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[358s] Generation 16: replaced=12 min=0.7154 mid=0.7156 max=0.7160 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[374s] Generation 17: replaced=14 min=0.7152 mid=0.7155 max=0.7159 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='pointer', pid_type='flat')
[391s] Generation 18: replaced=6 min=0.7152 mid=0.7155 max=0.7159 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='pointer', pid_type='flat')
[407s] Generation 19: replaced=7 min=0.7152 mid=0.7155 max=0.7159 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='pointer', pid_type='flat')
[407s] Autotuning complete in 407.7s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='pointer', pid_type='flat'))

100%|██████████| 16/16 [1:32:36<00:00, 416.97s/it]100%|██████████| 16/16 [1:32:36<00:00, 347.25s/it]

Benchmark Results:
    x_val    triton_add-speedup    helion_vector_add-speedup
---------  --------------------  ---------------------------
     4096              1.06294                      1
     8192              1.0069                       0.941936
    16384              1.01266                      1.08844
    32768              1.00667                      1.00667
    65536              1.00645                      0.939759
   131072              1.0117                       0.945355
   262144              0.949074                     0.953488
   524288              1                            1.05242
  1048576              0.994444                     1.06231
  2097152              0.975701                     1.02353
  4194304              0.997755                     1.05582
  8388608              0.992                        1.02155
 16777216              1.001                        1.01549
 33554432              1.0029                       1.01273
 67108864              1                            1.01529
134217728              1.00022                      1.01722
  average              1.00127                      1.0095

============================================================
Kernel: embedding
============================================================

Running embedding benchmark with Helion implementation...

  0%|          | 0/16 [00:00<?, ?it/s]INFO:tritonbench.utils.triton_op:Took 2.86ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 2.97ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 38.13ms to get benchmark function for inductor_embedding
/home/willfeng/local/pytorch-nightly/torch/backends/cuda/__init__.py:131: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:78.)
  return torch._C._get_cublas_allow_tf32()
INFO:tritonbench.utils.triton_op:Took 0.03ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 7 outliers from 685 samples
Removed 7 outliers from 619 samples
Removed 5 outliers from 603 samples
[63s] Timeout after 60s compiling Config(block_sizes=[4096, 16], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[2], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[True], num_warps=1, num_stages=8, indexing='block_ptr', pid_type='persistent_blocked')
[74s] Initial population: failed=3 min=0.0288 mid=0.1144 max=34.6708 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[126s] Generation 2: replaced=13 min=0.0288 mid=0.0362 max=0.0962 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[154s] Generation 3: replaced=19 min=0.0287 mid=0.0332 max=0.0949 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[216s] Timeout after 60s compiling Config(block_sizes=[1024, 512], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[1], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[False], num_warps=2, num_stages=2, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[238s] Generation 4: replaced=13 min=0.0287 mid=0.0318 max=0.0853 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[283s] Generation 5: replaced=15 min=0.0287 mid=0.0305 max=0.0449 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[336s] Generation 6: replaced=9 min=0.0287 mid=0.0303 max=0.0355 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[363s] Generation 7: replaced=13 min=0.0287 mid=0.0296 max=0.0338 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[402s] Generation 8: replaced=9 min=0.0287 mid=0.0294 max=0.0337 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[424s] Generation 9: replaced=15 min=0.0287 mid=0.0292 max=0.0317 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[456s] Generation 10: replaced=14 min=0.0286 mid=0.0292 max=0.0317 best=Config(block_sizes=[4, 512], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[481s] Generation 11: replaced=5 min=0.0286 mid=0.0292 max=0.0317 best=Config(block_sizes=[4, 512], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[501s] Generation 12: replaced=10 min=0.0286 mid=0.0290 max=0.0302 best=Config(block_sizes=[4, 512], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[524s] Generation 13: replaced=6 min=0.0286 mid=0.0289 max=0.0302 best=Config(block_sizes=[4, 512], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[546s] Generation 14: replaced=4 min=0.0283 mid=0.0289 max=0.0302 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[567s] Generation 15: replaced=8 min=0.0282 mid=0.0289 max=0.0296 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[587s] Generation 16: replaced=8 min=0.0282 mid=0.0289 max=0.0296 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[607s] Generation 17: replaced=9 min=0.0282 mid=0.0289 max=0.0292 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[627s] Generation 18: replaced=7 min=0.0282 mid=0.0288 max=0.0291 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[647s] Generation 19: replaced=2 min=0.0282 mid=0.0288 max=0.0291 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[647s] Autotuning complete in 647.6s after searching 1518 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

  6%|▋         | 1/16 [10:49<2:42:15, 649.03s/it]INFO:tritonbench.utils.triton_op:Took 5.36ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 5.56ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 7.27ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 6.26ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 2 outliers from 693 samples
Removed 5 outliers from 680 samples
Removed 8 outliers from 681 samples
Removed 1 outliers from 636 samples
[64s] Timeout after 60s compiling Config(block_sizes=[16384, 64], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[1], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[None], num_warps=32, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[74s] Initial population: failed=6 min=0.0318 mid=0.1346 max=32.6470 best=Config(block_sizes=[32, 1024], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[110s] Generation 2: replaced=11 min=0.0315 mid=0.0404 max=0.1439 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[142s] Generation 3: replaced=18 min=0.0315 mid=0.0372 max=0.0757 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[245s] Timeout after 60s compiling Config(block_sizes=[1024, 512], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[1], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='persistent_interleaved')
[259s] Generation 4: replaced=14 min=0.0315 mid=0.0346 max=0.0757 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[342s] Timeout after 60s compiling Config(block_sizes=[4096, 64], loop_orders=[[0, 1]], l2_groupings=[4], range_unroll_factors=[3], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[None], num_warps=4, num_stages=6, indexing='pointer', pid_type='persistent_interleaved')
[389s] Generation 5: replaced=8 min=0.0315 mid=0.0341 max=0.0716 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-26267:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 2304, in make_tensor_descriptor
    return _semantic.make_tensor_descriptor(base, shape, strides, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 1880, in make_tensor_descriptor
    type = tl.block_type(base.type.element_ty, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (2097152) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 2:15:
def _embedding_kernel(x_flat, weight, out, out_size_0, out_size_1, x_flat_size_0, out_stride_0, out_stride_1, weight_stride_0, weight_stride_1, x_flat_stride_0, embedding_dim, _NUM_SM: tl.constexpr, _BLOCK_SIZE_1: tl.constexpr, _BLOCK_SIZE_0: tl.constexpr):
    out_desc = tl.make_tensor_descriptor(out, [out_size_0, out_size_1], [out_stride_0, out_stride_1], [_BLOCK_SIZE_0, _BLOCK_SIZE_1])
               ^
[452s] Timeout after 60s compiling Config(block_sizes=[1024, 1024], loop_orders=[[1, 0]], l2_groupings=[64], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[False], num_warps=8, num_stages=5, indexing='pointer', pid_type='persistent_interleaved')
[490s] Generation 6: replaced=17 min=0.0315 mid=0.0331 max=0.0394 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[524s] Generation 7: replaced=9 min=0.0314 mid=0.0325 max=0.0360 best=Config(block_sizes=[256, 128], loop_orders=[[0, 1]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[570s] Generation 8: replaced=6 min=0.0314 mid=0.0324 max=0.0360 best=Config(block_sizes=[64, 128], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[643s] Generation 9: replaced=9 min=0.0313 mid=0.0323 max=0.0337 best=Config(block_sizes=[256, 128], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat')
[705s] Timeout after 60s compiling Config(block_sizes=[1024, 128], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=1, num_stages=6, indexing='pointer', pid_type='persistent_interleaved')
[727s] Generation 10: replaced=12 min=0.0313 mid=0.0322 max=0.0336 best=Config(block_sizes=[256, 128], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat')
[752s] Generation 11: replaced=11 min=0.0313 mid=0.0319 max=0.0336 best=Config(block_sizes=[256, 128], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat')
[781s] Generation 12: replaced=8 min=0.0313 mid=0.0319 max=0.0327 best=Config(block_sizes=[256, 128], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat')
[812s] Generation 13: replaced=11 min=0.0311 mid=0.0318 max=0.0325 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[839s] Generation 14: replaced=4 min=0.0311 mid=0.0317 max=0.0325 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[871s] Generation 15: replaced=5 min=0.0311 mid=0.0317 max=0.0322 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[897s] Generation 16: replaced=8 min=0.0311 mid=0.0316 max=0.0321 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[929s] Generation 17: replaced=5 min=0.0311 mid=0.0316 max=0.0321 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[964s] Generation 18: replaced=3 min=0.0311 mid=0.0316 max=0.0321 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1005s] Generation 19: replaced=7 min=0.0311 mid=0.0315 max=0.0321 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1005s] Autotuning complete in 1005.2s after searching 1515 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 12%|█▎        | 2/16 [27:35<3:20:27, 859.10s/it]INFO:tritonbench.utils.triton_op:Took 10.49ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 10.64ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 12.47ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 7.07ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 4 outliers from 672 samples
Removed 16 outliers from 659 samples
Removed 10 outliers from 669 samples
Removed 4 outliers from 591 samples
[22s] Initial population: failed=7 min=0.0368 mid=0.1732 max=37.6342 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[62s] Generation 2: replaced=14 min=0.0368 mid=0.0512 max=0.1826 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[93s] Generation 3: replaced=9 min=0.0356 mid=0.0408 max=0.1798 best=Config(block_sizes=[2, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[125s] Generation 4: replaced=18 min=0.0350 mid=0.0394 max=0.0755 best=Config(block_sizes=[64, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[187s] Timeout after 60s compiling Config(block_sizes=[128, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[True], num_warps=1, num_stages=7, indexing='pointer', pid_type='persistent_blocked')
[213s] Generation 5: replaced=9 min=0.0348 mid=0.0388 max=0.0755 best=Config(block_sizes=[32, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[245s] Generation 6: replaced=10 min=0.0348 mid=0.0373 max=0.0719 best=Config(block_sizes=[32, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[338s] Timeout after 60s compiling Config(block_sizes=[2048, 512], loop_orders=[[0, 1]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[352s] Generation 7: replaced=10 min=0.0348 mid=0.0370 max=0.0629 best=Config(block_sizes=[32, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[437s] Timeout after 60s compiling Config(block_sizes=[2048, 256], loop_orders=[[1, 0]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[False], range_flattens=[True], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='persistent_interleaved')
[539s] Timeout after 60s compiling Config(block_sizes=[2048, 512], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[539s] Generation 8: replaced=11 min=0.0340 mid=0.0369 max=0.0426 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[578s] Generation 9: replaced=14 min=0.0340 mid=0.0362 max=0.0426 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[638s] Timeout after 60s compiling Config(block_sizes=[512, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[671s] Generation 10: replaced=13 min=0.0340 mid=0.0360 max=0.0396 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[711s] Generation 11: replaced=11 min=0.0340 mid=0.0358 max=0.0373 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[767s] Generation 12: replaced=8 min=0.0340 mid=0.0357 max=0.0373 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[829s] Generation 13: replaced=8 min=0.0340 mid=0.0355 max=0.0371 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[883s] Generation 14: replaced=10 min=0.0340 mid=0.0353 max=0.0371 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[913s] Generation 15: replaced=8 min=0.0340 mid=0.0352 max=0.0366 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[973s] Timeout after 60s compiling Config(block_sizes=[512, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[994s] Generation 16: replaced=8 min=0.0340 mid=0.0352 max=0.0366 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1048s] Generation 17: replaced=6 min=0.0340 mid=0.0352 max=0.0366 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1071s] Generation 18: replaced=8 min=0.0340 mid=0.0350 max=0.0361 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1132s] Timeout after 60s compiling Config(block_sizes=[1024, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1155s] Generation 19: replaced=4 min=0.0340 mid=0.0350 max=0.0361 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1155s] Autotuning complete in 1155.8s after searching 1513 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 19%|█▉        | 3/16 [46:51<3:35:34, 994.96s/it]INFO:tritonbench.utils.triton_op:Took 20.89ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 28.03ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 30.58ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.39ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 8 outliers from 670 samples
Removed 13 outliers from 638 samples
Removed 1 outliers from 647 samples
Removed 10 outliers from 604 samples
[65s] Timeout after 60s compiling Config(block_sizes=[8192, 128], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[74s] Initial population: failed=9 min=0.0416 mid=0.1911 max=23.8086 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[100s] Generation 2: replaced=20 min=0.0416 mid=0.0543 max=0.1715 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[153s] Generation 3: replaced=19 min=0.0416 mid=0.0468 max=0.1233 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[190s] Generation 4: replaced=13 min=0.0397 mid=0.0452 max=0.0900 best=Config(block_sizes=[256, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[222s] Generation 5: replaced=10 min=0.0397 mid=0.0446 max=0.0900 best=Config(block_sizes=[256, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[322s] Timeout after 60s compiling Config(block_sizes=[256, 512], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=1, num_stages=5, indexing='pointer', pid_type='persistent_interleaved')
[328s] Generation 6: replaced=15 min=0.0397 mid=0.0432 max=0.0514 best=Config(block_sizes=[256, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[358s] Generation 7: replaced=20 min=0.0397 mid=0.0428 max=0.0514 best=Config(block_sizes=[256, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[386s] Generation 8: replaced=6 min=0.0396 mid=0.0428 max=0.0514 best=Config(block_sizes=[32, 128], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[416s] Generation 9: replaced=7 min=0.0396 mid=0.0421 max=0.0514 best=Config(block_sizes=[32, 128], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[448s] Generation 10: replaced=8 min=0.0396 mid=0.0420 max=0.0514 best=Config(block_sizes=[32, 128], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[477s] Generation 11: replaced=11 min=0.0392 mid=0.0418 max=0.0437 best=Config(block_sizes=[256, 128], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[556s] Generation 12: replaced=8 min=0.0392 mid=0.0418 max=0.0433 best=Config(block_sizes=[256, 128], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[614s] Generation 13: replaced=14 min=0.0392 mid=0.0414 max=0.0433 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[677s] Timeout after 60s compiling Config(block_sizes=[512, 512], loop_orders=[[1, 0]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[700s] Generation 14: replaced=13 min=0.0392 mid=0.0413 max=0.0427 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[750s] Generation 15: replaced=8 min=0.0391 mid=0.0405 max=0.0427 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[792s] Generation 16: replaced=10 min=0.0391 mid=0.0401 max=0.0427 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[835s] Generation 17: replaced=9 min=0.0391 mid=0.0399 max=0.0424 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[868s] Generation 18: replaced=6 min=0.0391 mid=0.0398 max=0.0424 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[894s] Generation 19: replaced=10 min=0.0391 mid=0.0397 max=0.0424 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[894s] Autotuning complete in 894.7s after searching 1517 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 25%|██▌       | 4/16 [1:01:47<3:11:08, 955.71s/it]INFO:tritonbench.utils.triton_op:Took 57.46ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 58.49ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 59.65ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.83ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 5 outliers from 649 samples
Removed 6 outliers from 619 samples
Removed 3 outliers from 625 samples
Removed 9 outliers from 598 samples
[22s] Initial population: failed=7 min=0.0453 mid=0.1910 max=10.2524 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[66s] Generation 2: replaced=17 min=0.0453 mid=0.0556 max=0.1865 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[130s] Timeout after 60s compiling Config(block_sizes=[256, 1024], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[2], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='persistent_blocked')
[158s] Generation 3: replaced=13 min=0.0453 mid=0.0532 max=0.1030 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[197s] Generation 4: replaced=18 min=0.0453 mid=0.0499 max=0.0774 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[247s] Generation 5: replaced=15 min=0.0453 mid=0.0479 max=0.0679 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[281s] Generation 6: replaced=13 min=0.0450 mid=0.0476 max=0.0628 best=Config(block_sizes=[512, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[315s] Generation 7: replaced=9 min=0.0450 mid=0.0474 max=0.0558 best=Config(block_sizes=[512, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[391s] Generation 8: replaced=8 min=0.0450 mid=0.0472 max=0.0492 best=Config(block_sizes=[512, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[451s] Timeout after 60s compiling Config(block_sizes=[512, 1024], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[475s] Generation 9: replaced=4 min=0.0450 mid=0.0471 max=0.0489 best=Config(block_sizes=[512, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[502s] Generation 10: replaced=13 min=0.0443 mid=0.0469 max=0.0487 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[528s] Generation 11: replaced=8 min=0.0443 mid=0.0466 max=0.0478 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[555s] Generation 12: replaced=14 min=0.0443 mid=0.0465 max=0.0476 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[688s] Timeout after 60s compiling Config(block_sizes=[256, 1024], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[701s] Generation 13: replaced=14 min=0.0443 mid=0.0460 max=0.0473 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[732s] Generation 14: replaced=6 min=0.0443 mid=0.0460 max=0.0469 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[773s] Generation 15: replaced=8 min=0.0441 mid=0.0459 max=0.0469 best=Config(block_sizes=[16, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[801s] Generation 16: replaced=7 min=0.0441 mid=0.0457 max=0.0466 best=Config(block_sizes=[16, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[829s] Generation 17: replaced=11 min=0.0441 mid=0.0453 max=0.0465 best=Config(block_sizes=[16, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[857s] Generation 18: replaced=9 min=0.0441 mid=0.0450 max=0.0465 best=Config(block_sizes=[16, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[885s] Generation 19: replaced=9 min=0.0441 mid=0.0449 max=0.0465 best=Config(block_sizes=[16, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[885s] Autotuning complete in 885.9s after searching 1517 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[16, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 31%|███▏      | 5/16 [1:16:34<2:50:39, 930.89s/it]INFO:tritonbench.utils.triton_op:Took 115.47ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 116.36ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 118.08ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 6.01ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 7 outliers from 627 samples
Removed 8 outliers from 607 samples
Removed 10 outliers from 610 samples
Removed 13 outliers from 594 samples
[17s] Initial population: failed=3 min=0.0500 mid=0.2597 max=45.8850 best=Config(block_sizes=[1, 1024], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[133s] Timeout after 60s compiling Config(block_sizes=[16384, 1], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[2], range_num_stages=[4], range_multi_buffers=[None], range_flattens=[False], num_warps=1, num_stages=2, indexing='pointer', pid_type='persistent_interleaved')
[147s] Generation 2: replaced=18 min=0.0497 mid=0.0563 max=0.2396 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[209s] Timeout after 60s compiling Config(block_sizes=[128, 512], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[4], range_num_stages=[4], range_multi_buffers=[True], range_flattens=[True], num_warps=1, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[209s] Timeout after 61s compiling Config(block_sizes=[1024, 256], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[3], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=1, num_stages=1, indexing='block_ptr', pid_type='persistent_blocked')
[209s] Timeout after 60s compiling Config(block_sizes=[1024, 512], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[False], num_warps=2, num_stages=8, indexing='pointer', pid_type='persistent_blocked')
[253s] Generation 3: replaced=16 min=0.0490 mid=0.0526 max=0.0759 best=Config(block_sizes=[16, 256], loop_orders=[[1, 0]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[302s] Generation 4: replaced=8 min=0.0485 mid=0.0518 max=0.0759 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[337s] Generation 5: replaced=10 min=0.0485 mid=0.0511 max=0.0759 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[383s] Generation 6: replaced=11 min=0.0485 mid=0.0508 max=0.0759 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[422s] Generation 7: replaced=10 min=0.0485 mid=0.0505 max=0.0554 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[492s] Generation 8: replaced=7 min=0.0485 mid=0.0504 max=0.0548 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[531s] Generation 9: replaced=16 min=0.0485 mid=0.0499 max=0.0535 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[580s] Generation 10: replaced=13 min=0.0485 mid=0.0498 max=0.0524 best=Config(block_sizes=[256, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[609s] Generation 11: replaced=18 min=0.0478 mid=0.0494 max=0.0520 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[643s] Generation 12: replaced=5 min=0.0478 mid=0.0492 max=0.0520 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[677s] Generation 13: replaced=7 min=0.0478 mid=0.0491 max=0.0507 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[714s] Generation 14: replaced=6 min=0.0478 mid=0.0491 max=0.0503 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[742s] Generation 15: replaced=12 min=0.0478 mid=0.0490 max=0.0502 best=Config(block_sizes=[32, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[771s] Generation 16: replaced=12 min=0.0477 mid=0.0489 max=0.0502 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[799s] Generation 17: replaced=8 min=0.0477 mid=0.0488 max=0.0502 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[828s] Generation 18: replaced=3 min=0.0477 mid=0.0488 max=0.0497 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[859s] Generation 19: replaced=6 min=0.0477 mid=0.0488 max=0.0497 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[859s] Autotuning complete in 859.6s after searching 1516 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 38%|███▊      | 6/16 [1:30:55<2:31:10, 907.08s/it]INFO:tritonbench.utils.triton_op:Took 251.26ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 260.36ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 257.25ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 7.18ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 8 outliers from 609 samples
Removed 11 outliers from 599 samples
Removed 8 outliers from 595 samples
[42s] Initial population: failed=6 min=0.0512 mid=0.1734 max=42.6625 best=Config(block_sizes=[4, 1024], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[92s] Generation 2: replaced=19 min=0.0510 mid=0.0617 max=0.1890 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[131s] Generation 3: replaced=13 min=0.0510 mid=0.0564 max=0.1544 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[251s] Timeout after 60s compiling Config(block_sizes=[8192, 16], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[3], range_num_stages=[4], range_multi_buffers=[True], range_flattens=[True], num_warps=2, num_stages=4, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[253s] Generation 4: replaced=18 min=0.0510 mid=0.0530 max=0.1544 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[298s] Generation 5: replaced=14 min=0.0510 mid=0.0525 max=0.0617 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[334s] Generation 6: replaced=12 min=0.0509 mid=0.0521 max=0.0584 best=Config(block_sizes=[2, 1024], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[366s] Generation 7: replaced=17 min=0.0504 mid=0.0517 max=0.0584 best=Config(block_sizes=[16, 256], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[395s] Generation 8: replaced=17 min=0.0504 mid=0.0513 max=0.0527 best=Config(block_sizes=[16, 256], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[448s] Generation 9: replaced=14 min=0.0502 mid=0.0512 max=0.0526 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[475s] Generation 10: replaced=10 min=0.0501 mid=0.0511 max=0.0526 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[506s] Generation 11: replaced=11 min=0.0500 mid=0.0511 max=0.0517 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[536s] Generation 12: replaced=6 min=0.0500 mid=0.0510 max=0.0516 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[563s] Generation 13: replaced=8 min=0.0500 mid=0.0508 max=0.0516 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[590s] Generation 14: replaced=4 min=0.0500 mid=0.0506 max=0.0516 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[615s] Generation 15: replaced=6 min=0.0500 mid=0.0506 max=0.0516 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[642s] Generation 16: replaced=4 min=0.0500 mid=0.0506 max=0.0513 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[667s] Generation 17: replaced=5 min=0.0499 mid=0.0506 max=0.0513 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[691s] Generation 18: replaced=9 min=0.0497 mid=0.0505 max=0.0513 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[718s] Generation 19: replaced=4 min=0.0497 mid=0.0504 max=0.0512 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[718s] Autotuning complete in 718.5s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 44%|████▍     | 7/16 [1:42:55<2:06:54, 846.03s/it]INFO:tritonbench.utils.triton_op:Took 467.96ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 499.09ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 486.73ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.66ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 2 outliers from 595 samples
Removed 5 outliers from 600 samples
Removed 2 outliers from 595 samples
Removed 12 outliers from 569 samples
[38s] Initial population: failed=5 min=0.0532 mid=0.1234 max=10.2670 best=Config(block_sizes=[8, 32], loop_orders=[[1, 0]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[102s] Generation 2: replaced=13 min=0.0526 mid=0.0585 max=0.1015 best=Config(block_sizes=[256, 64], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[150s] Generation 3: replaced=14 min=0.0518 mid=0.0561 max=0.0911 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[212s] Timeout after 60s compiling Config(block_sizes=[256, 256], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[3], range_num_stages=[4], range_multi_buffers=[True], range_flattens=[True], num_warps=1, num_stages=5, indexing='pointer', pid_type='persistent_interleaved')
[287s] Timeout after 60s compiling Config(block_sizes=[512, 128], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='block_ptr', pid_type='persistent_interleaved')
[307s] Generation 4: replaced=12 min=0.0518 mid=0.0551 max=0.0899 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[358s] Generation 5: replaced=9 min=0.0518 mid=0.0550 max=0.0729 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[409s] Generation 6: replaced=8 min=0.0518 mid=0.0545 max=0.0729 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[453s] Generation 7: replaced=8 min=0.0518 mid=0.0542 max=0.0680 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[502s] Generation 8: replaced=12 min=0.0518 mid=0.0536 max=0.0680 best=Config(block_sizes=[8, 256], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[543s] Generation 9: replaced=11 min=0.0518 mid=0.0530 max=0.0603 best=Config(block_sizes=[8, 256], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[604s] Generation 10: replaced=14 min=0.0518 mid=0.0529 max=0.0603 best=Config(block_sizes=[8, 256], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[653s] Generation 11: replaced=11 min=0.0514 mid=0.0526 max=0.0588 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[684s] Generation 12: replaced=13 min=0.0513 mid=0.0525 max=0.0588 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[720s] Generation 13: replaced=15 min=0.0513 mid=0.0521 max=0.0532 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[750s] Generation 14: replaced=8 min=0.0507 mid=0.0520 max=0.0531 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[779s] Generation 15: replaced=7 min=0.0507 mid=0.0520 max=0.0527 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[817s] Generation 16: replaced=8 min=0.0507 mid=0.0519 max=0.0527 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[848s] Generation 17: replaced=7 min=0.0507 mid=0.0518 max=0.0527 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[876s] Generation 18: replaced=7 min=0.0507 mid=0.0517 max=0.0526 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[903s] Generation 19: replaced=7 min=0.0507 mid=0.0515 max=0.0525 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[903s] Autotuning complete in 903.9s after searching 1518 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 50%|█████     | 8/16 [1:58:01<1:55:22, 865.30s/it]INFO:tritonbench.utils.triton_op:Took 13.88ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 18.80ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 20.30ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.80ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 6 outliers from 605 samples
Removed 7 outliers from 400 samples
Removed 2 outliers from 373 samples
Removed 3 outliers from 329 samples
[68s] Timeout after 60s compiling Config(block_sizes=[8192, 128], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[1], range_num_stages=[4], range_multi_buffers=[None], range_flattens=[False], num_warps=32, num_stages=5, indexing='pointer', pid_type='persistent_interleaved')
[79s] Initial population: failed=5 min=0.1556 mid=0.9123 max=66.1243 best=Config(block_sizes=[16, 32], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-36589:
Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 23:35:
        first_pid_m = group_id * 16
        group_size_m = min(num_pid_m - first_pid_m, 16)
        pid_0 = first_pid_m + inner_2d_pid % num_pid_in_group % group_size_m
        pid_1 = inner_2d_pid % num_pid_in_group // group_size_m
        offset_0 = pid_0 * _BLOCK_SIZE_0
        indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
        mask_0 = indices_0 < x_flat_size_0
        offset_1 = pid_1 * _BLOCK_SIZE_1
        indices_1 = (offset_1 + tl.arange(0, _BLOCK_SIZE_1)).to(tl.int32)
        mask_1 = indices_1 < embedding_dim
        load = tl.load(tl.make_block_ptr(x_flat, [x_flat_size_0], [x_flat_stride_0], [offset_0], [_BLOCK_SIZE_0], [0]), boundary_check=[0], padding_option='zero')
        load_1 = tl.load(weight + (load[:, None] * weight_stride_0 + indices_1[None, :] * weight_stride_1), mask_0[:, None] & mask_1[None, :], other=0)
                                   ^
ValueError('numel (2097152) exceeds triton maximum tensor numel (1048576)')
[177s] Generation 2: replaced=16 min=0.1377 mid=0.2056 max=0.9364 best=Config(block_sizes=[128, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-36669:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 2304, in make_tensor_descriptor
    return _semantic.make_tensor_descriptor(base, shape, strides, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 1880, in make_tensor_descriptor
    type = tl.block_type(base.type.element_ty, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (4194304) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 2:15:
def _embedding_kernel(x_flat, weight, out, out_size_0, out_size_1, x_flat_size_0, out_stride_0, out_stride_1, weight_stride_0, weight_stride_1, x_flat_stride_0, embedding_dim, _BLOCK_SIZE_1: tl.constexpr, _BLOCK_SIZE_0: tl.constexpr):
    out_desc = tl.make_tensor_descriptor(out, [out_size_0, out_size_1], [out_stride_0, out_stride_1], [_BLOCK_SIZE_0, _BLOCK_SIZE_1])
               ^
[238s] Timeout after 60s compiling Config(block_sizes=[1024, 1024], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[4], range_multi_buffers=[True], range_flattens=[None], num_warps=8, num_stages=8, indexing='pointer', pid_type='persistent_blocked')
[238s] Timeout after 60s compiling Config(block_sizes=[64, 4096], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[False], num_warps=1, num_stages=2, indexing='pointer', pid_type='persistent_interleaved')
[304s] Timeout after 60s compiling Config(block_sizes=[64, 4096], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
Process ForkProcess-36696:
Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 20:35:
        first_pid_m = group_id * 32
        group_size_m = min(num_pid_m - first_pid_m, 32)
        pid_0 = first_pid_m + inner_2d_pid % num_pid_in_group % group_size_m
        pid_1 = inner_2d_pid % num_pid_in_group // group_size_m
        offset_1 = pid_0 * _BLOCK_SIZE_1
        indices_1 = (offset_1 + tl.arange(0, _BLOCK_SIZE_1)).to(tl.int32)
        mask_1 = indices_1 < embedding_dim
        offset_0 = pid_1 * _BLOCK_SIZE_0
        indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
        mask_0 = indices_0 < x_flat_size_0
        load = tl.load(x_flat + indices_0 * x_flat_stride_0, mask_0, other=0)
        load_1 = tl.load(weight + (load[:, None] * weight_stride_0 + indices_1[None, :] * weight_stride_1), mask_0[:, None] & mask_1[None, :], other=0)
                                   ^
ValueError('numel (4194304) exceeds triton maximum tensor numel (1048576)')
[324s] Generation 3: replaced=17 min=0.1339 mid=0.1747 max=0.7974 best=Config(block_sizes=[2, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[387s] Timeout after 60s compiling Config(block_sizes=[8192, 8], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[3], range_num_stages=[4], range_multi_buffers=[None], range_flattens=[True], num_warps=2, num_stages=4, indexing='block_ptr', pid_type='persistent_blocked')
[473s] Timeout after 60s compiling Config(block_sizes=[256, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[3], range_num_stages=[1], range_multi_buffers=[True], range_flattens=[None], num_warps=1, num_stages=1, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[478s] Generation 4: replaced=14 min=0.1335 mid=0.1619 max=0.6293 best=Config(block_sizes=[1, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[559s] Generation 5: replaced=10 min=0.1335 mid=0.1590 max=0.6293 best=Config(block_sizes=[1, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[650s] Timeout after 60s compiling Config(block_sizes=[4096, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[1], range_multi_buffers=[False], range_flattens=[True], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='persistent_blocked')
[660s] Generation 6: replaced=9 min=0.1324 mid=0.1582 max=0.6293 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[718s] Generation 7: replaced=8 min=0.1324 mid=0.1526 max=0.1977 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[803s] Timeout after 60s compiling Config(block_sizes=[64, 2048], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[4], range_num_stages=[1], range_multi_buffers=[True], range_flattens=[True], num_warps=1, num_stages=8, indexing='pointer', pid_type='persistent_blocked')
[808s] Generation 8: replaced=7 min=0.1324 mid=0.1500 max=0.1913 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[870s] Timeout after 60s compiling Config(block_sizes=[256, 1024], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[902s] Generation 9: replaced=8 min=0.1324 mid=0.1474 max=0.1745 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[954s] Generation 10: replaced=3 min=0.1324 mid=0.1465 max=0.1745 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[993s] Generation 11: replaced=4 min=0.1324 mid=0.1438 max=0.1745 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1022s] Generation 12: replaced=11 min=0.1324 mid=0.1410 max=0.1619 best=Config(block_sizes=[32, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1084s] Timeout after 60s compiling Config(block_sizes=[512, 512], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[3], range_num_stages=[1], range_multi_buffers=[True], range_flattens=[True], num_warps=1, num_stages=8, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[1118s] Generation 13: replaced=3 min=0.1324 mid=0.1389 max=0.1619 best=Config(block_sizes=[2, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1162s] Generation 14: replaced=5 min=0.1324 mid=0.1381 max=0.1619 best=Config(block_sizes=[2, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1195s] Generation 15: replaced=5 min=0.1324 mid=0.1381 max=0.1619 best=Config(block_sizes=[2, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1227s] Generation 16: replaced=6 min=0.1324 mid=0.1376 max=0.1582 best=Config(block_sizes=[2, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1275s] Generation 17: replaced=4 min=0.1319 mid=0.1374 max=0.1582 best=Config(block_sizes=[8, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1320s] Generation 18: replaced=5 min=0.1319 mid=0.1366 max=0.1582 best=Config(block_sizes=[8, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1351s] Generation 19: replaced=5 min=0.1319 mid=0.1359 max=0.1582 best=Config(block_sizes=[8, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1351s] Autotuning complete in 1351.1s after searching 1510 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[8, 512], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 56%|█████▋    | 9/16 [2:20:34<1:58:42, 1017.54s/it]INFO:tritonbench.utils.triton_op:Took 37.65ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 39.15ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 40.74ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.94ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 5 outliers from 402 samples
Removed 6 outliers from 366 samples
Removed 5 outliers from 370 samples
Removed 3 outliers from 300 samples
[59s] Initial population: failed=8 min=0.1556 mid=0.8391 max=141.4365 best=Config(block_sizes=[2, 512], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-38141:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 2304, in make_tensor_descriptor
    return _semantic.make_tensor_descriptor(base, shape, strides, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 1880, in make_tensor_descriptor
    type = tl.block_type(base.type.element_ty, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (2097152) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 2:15:
def _embedding_kernel(x_flat, weight, out, out_size_0, out_size_1, x_flat_size_0, out_stride_0, out_stride_1, weight_stride_0, weight_stride_1, x_flat_stride_0, embedding_dim, _NUM_SM: tl.constexpr, _BLOCK_SIZE_1: tl.constexpr, _BLOCK_SIZE_0: tl.constexpr):
    out_desc = tl.make_tensor_descriptor(out, [out_size_0, out_size_1], [out_stride_0, out_stride_1], [_BLOCK_SIZE_0, _BLOCK_SIZE_1])
               ^
[142s] Generation 2: replaced=14 min=0.1550 mid=0.2679 max=0.9346 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[178s] Generation 3: replaced=10 min=0.1550 mid=0.2224 max=0.9346 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[239s] Timeout after 60s compiling Config(block_sizes=[1024, 256], loop_orders=[[1, 0]], l2_groupings=[16], range_unroll_factors=[3], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[True], num_warps=2, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[241s] Timeout after 60s compiling Config(block_sizes=[256, 512], loop_orders=[[1, 0]], l2_groupings=[16], range_unroll_factors=[4], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[False], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='persistent_blocked')
[275s] Generation 4: replaced=11 min=0.1550 mid=0.2129 max=0.9346 best=Config(block_sizes=[64, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[358s] Timeout after 60s compiling Config(block_sizes=[2048, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[1], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[False], num_warps=1, num_stages=3, indexing='block_ptr', pid_type='persistent_blocked')
[371s] Generation 5: replaced=6 min=0.1545 mid=0.2125 max=0.9346 best=Config(block_sizes=[32, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[448s] Generation 6: replaced=13 min=0.1545 mid=0.1871 max=0.9346 best=Config(block_sizes=[32, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[483s] Generation 7: replaced=11 min=0.1545 mid=0.1799 max=0.9326 best=Config(block_sizes=[32, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[569s] Generation 8: replaced=9 min=0.1502 mid=0.1701 max=0.2649 best=Config(block_sizes=[16, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[633s] Generation 9: replaced=11 min=0.1502 mid=0.1649 max=0.2238 best=Config(block_sizes=[16, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[690s] Generation 10: replaced=4 min=0.1502 mid=0.1634 max=0.2238 best=Config(block_sizes=[16, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[727s] Generation 11: replaced=8 min=0.1502 mid=0.1620 max=0.2211 best=Config(block_sizes=[16, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[769s] Generation 12: replaced=7 min=0.1502 mid=0.1607 max=0.2139 best=Config(block_sizes=[16, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[834s] Generation 13: replaced=4 min=0.1502 mid=0.1602 max=0.2139 best=Config(block_sizes=[16, 64], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[868s] Generation 14: replaced=7 min=0.1498 mid=0.1572 max=0.1694 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[955s] Generation 15: replaced=8 min=0.1477 mid=0.1551 max=0.1694 best=Config(block_sizes=[4, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat')
[992s] Generation 16: replaced=7 min=0.1477 mid=0.1550 max=0.1670 best=Config(block_sizes=[4, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat')
[1027s] Generation 17: replaced=10 min=0.1460 mid=0.1537 max=0.1670 best=Config(block_sizes=[4, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1063s] Generation 18: replaced=6 min=0.1460 mid=0.1533 max=0.1670 best=Config(block_sizes=[4, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1092s] Generation 19: replaced=6 min=0.1460 mid=0.1521 max=0.1670 best=Config(block_sizes=[4, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1092s] Autotuning complete in 1092.7s after searching 1517 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 62%|██████▎   | 10/16 [2:38:47<1:44:06, 1041.05s/it]INFO:tritonbench.utils.triton_op:Took 86.59ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 88.68ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 90.82ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 7.41ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 11 outliers from 370 samples
Removed 2 outliers from 336 samples
Removed 9 outliers from 351 samples
Removed 1 outliers from 271 samples
[27s] Initial population: failed=5 min=0.1767 mid=0.6700 max=40.3543 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[83s] Generation 2: replaced=12 min=0.1767 mid=0.2353 max=0.6382 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[137s] Generation 3: replaced=17 min=0.1679 mid=0.2285 max=0.6382 best=Config(block_sizes=[32, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[237s] Generation 4: replaced=9 min=0.1678 mid=0.2281 max=0.6289 best=Config(block_sizes=[64, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[281s] Generation 5: replaced=11 min=0.1678 mid=0.2168 max=0.3088 best=Config(block_sizes=[64, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[324s] Generation 6: replaced=14 min=0.1662 mid=0.2126 max=0.2860 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[416s] Generation 7: replaced=8 min=0.1662 mid=0.2116 max=0.2860 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[461s] Generation 8: replaced=10 min=0.1662 mid=0.1901 max=0.2860 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[493s] Generation 9: replaced=12 min=0.1662 mid=0.1796 max=0.2384 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[535s] Generation 10: replaced=7 min=0.1662 mid=0.1780 max=0.2365 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[569s] Generation 11: replaced=5 min=0.1662 mid=0.1768 max=0.2365 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[613s] Generation 12: replaced=6 min=0.1662 mid=0.1737 max=0.2283 best=Config(block_sizes=[8, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[650s] Generation 13: replaced=7 min=0.1661 mid=0.1720 max=0.2283 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[681s] Generation 14: replaced=7 min=0.1661 mid=0.1717 max=0.2247 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[720s] Generation 15: replaced=8 min=0.1661 mid=0.1704 max=0.2140 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[756s] Generation 16: replaced=8 min=0.1661 mid=0.1690 max=0.2140 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[791s] Generation 17: replaced=6 min=0.1658 mid=0.1686 max=0.2040 best=Config(block_sizes=[8, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[833s] Generation 18: replaced=8 min=0.1658 mid=0.1683 max=0.1941 best=Config(block_sizes=[8, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[870s] Generation 19: replaced=6 min=0.1658 mid=0.1683 max=0.1941 best=Config(block_sizes=[8, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[870s] Autotuning complete in 870.6s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[8, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 69%|██████▉   | 11/16 [2:53:19<1:22:26, 989.26s/it] INFO:tritonbench.utils.triton_op:Took 166.63ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 168.14ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 169.80ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 7.66ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 38 outliers from 348 samples
Removed 1 outliers from 306 samples
Removed 7 outliers from 320 samples
Removed 3 outliers from 262 samples
Process ForkProcess-41119:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 2304, in make_tensor_descriptor
    return _semantic.make_tensor_descriptor(base, shape, strides, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 1880, in make_tensor_descriptor
    type = tl.block_type(base.type.element_ty, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (2097152) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 2:15:
def _embedding_kernel(x_flat, weight, out, out_size_0, out_size_1, x_flat_size_0, out_stride_0, out_stride_1, weight_stride_0, weight_stride_1, x_flat_stride_0, embedding_dim, _BLOCK_SIZE_1: tl.constexpr, _BLOCK_SIZE_0: tl.constexpr):
    out_desc = tl.make_tensor_descriptor(out, [out_size_0, out_size_1], [out_stride_0, out_stride_1], [_BLOCK_SIZE_0, _BLOCK_SIZE_1])
               ^
[47s] Initial population: failed=5 min=0.2034 mid=1.0092 max=38.8612 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=8, num_stages=3, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[108s] Timeout after 60s compiling Config(block_sizes=[128, 4096], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[2], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='persistent_interleaved')
[176s] Timeout after 60s compiling Config(block_sizes=[512, 1024], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[True], num_warps=2, num_stages=8, indexing='tensor_descriptor', pid_type='persistent_blocked')
[247s] Timeout after 60s compiling Config(block_sizes=[128, 1024], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[4], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=1, num_stages=8, indexing='tensor_descriptor', pid_type='persistent_blocked')
[283s] Generation 2: replaced=13 min=0.2034 mid=0.2990 max=1.0913 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=8, num_stages=3, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[390s] Timeout after 60s compiling Config(block_sizes=[512, 2048], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=4, indexing='block_ptr', pid_type='persistent_interleaved')
[422s] Generation 3: replaced=21 min=0.1953 mid=0.2526 max=0.9894 best=Config(block_sizes=[64, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[522s] Generation 4: replaced=12 min=0.1953 mid=0.2471 max=0.9894 best=Config(block_sizes=[64, 64], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[584s] Generation 5: replaced=9 min=0.1949 mid=0.2436 max=0.9894 best=Config(block_sizes=[16, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[624s] Generation 6: replaced=8 min=0.1949 mid=0.2423 max=0.3008 best=Config(block_sizes=[16, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[687s] Generation 7: replaced=14 min=0.1949 mid=0.2341 max=0.2732 best=Config(block_sizes=[16, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[773s] Generation 8: replaced=14 min=0.1937 mid=0.2257 max=0.2511 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[809s] Generation 9: replaced=9 min=0.1911 mid=0.2222 max=0.2425 best=Config(block_sizes=[64, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[855s] Generation 10: replaced=9 min=0.1911 mid=0.2126 max=0.2425 best=Config(block_sizes=[64, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[887s] Generation 11: replaced=5 min=0.1911 mid=0.2084 max=0.2410 best=Config(block_sizes=[64, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[920s] Generation 12: replaced=12 min=0.1907 mid=0.2077 max=0.2410 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[982s] Timeout after 60s compiling Config(block_sizes=[256, 4096], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1011s] Generation 13: replaced=10 min=0.1905 mid=0.2035 max=0.2410 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1073s] Timeout after 60s compiling Config(block_sizes=[64, 1024], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[None], num_warps=1, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[1100s] Generation 14: replaced=7 min=0.1905 mid=0.1968 max=0.2410 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1133s] Generation 15: replaced=10 min=0.1900 mid=0.1954 max=0.2410 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1167s] Generation 16: replaced=6 min=0.1900 mid=0.1951 max=0.2219 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1208s] Generation 17: replaced=6 min=0.1900 mid=0.1944 max=0.2219 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1241s] Generation 18: replaced=3 min=0.1900 mid=0.1939 max=0.2219 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1276s] Generation 19: replaced=6 min=0.1900 mid=0.1938 max=0.2174 best=Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1276s] Autotuning complete in 1276.3s after searching 1514 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[8, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 75%|███████▌  | 12/16 [3:14:37<1:11:48, 1077.04s/it]INFO:tritonbench.utils.triton_op:Took 307.19ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 308.22ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 308.65ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.74ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 1 outliers from 327 samples
Removed 1 outliers from 290 samples
Removed 3 outliers from 298 samples
[61s] Timeout after 60s compiling Config(block_sizes=[2048, 64], loop_orders=[[0, 1]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[False], num_warps=2, num_stages=7, indexing='pointer', pid_type='persistent_interleaved')
[65s] Timeout after 60s compiling Config(block_sizes=[8192, 64], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=8, num_stages=8, indexing='block_ptr', pid_type='persistent_blocked')
[68s] Timeout after 60s compiling Config(block_sizes=[512, 128], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=1, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[77s] Initial population: failed=13 min=0.2349 mid=0.6819 max=40.2511 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[119s] Generation 2: replaced=19 min=0.2210 mid=0.2593 max=0.7541 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[180s] Generation 3: replaced=16 min=0.2210 mid=0.2565 max=0.7541 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-42824:
Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 20:35:
        first_pid_m = group_id * 64
        group_size_m = min(num_pid_m - first_pid_m, 64)
        pid_0 = first_pid_m + inner_2d_pid % num_pid_in_group % group_size_m
        pid_1 = inner_2d_pid % num_pid_in_group // group_size_m
        offset_0 = pid_0 * _BLOCK_SIZE_0
        indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
        mask_0 = indices_0 < x_flat_size_0
        offset_1 = pid_1 * _BLOCK_SIZE_1
        indices_1 = (offset_1 + tl.arange(0, _BLOCK_SIZE_1)).to(tl.int32)
        mask_1 = indices_1 < embedding_dim
        load = tl.load(x_flat + indices_0 * x_flat_stride_0, mask_0, other=0)
        load_1 = tl.load(weight + (load[:, None] * weight_stride_0 + indices_1[None, :] * weight_stride_1), mask_0[:, None] & mask_1[None, :], other=0)
                                   ^
ValueError('numel (4194304) exceeds triton maximum tensor numel (1048576)')
[244s] Timeout after 60s compiling Config(block_sizes=[64, 2048], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=4, indexing='pointer', pid_type='persistent_interleaved')
[339s] Timeout after 60s compiling Config(block_sizes=[128, 1024], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[3], range_num_stages=[2], range_multi_buffers=[True], range_flattens=[True], num_warps=1, num_stages=3, indexing='tensor_descriptor', pid_type='persistent_blocked')
[344s] Generation 4: replaced=16 min=0.2210 mid=0.2527 max=0.3966 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[383s] Generation 5: replaced=13 min=0.2210 mid=0.2496 max=0.2920 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[424s] Generation 6: replaced=8 min=0.2210 mid=0.2483 max=0.2622 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-43116:
Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 20:35:
        first_pid_m = group_id * 16
        group_size_m = min(num_pid_m - first_pid_m, 16)
        pid_0 = first_pid_m + inner_2d_pid % num_pid_in_group % group_size_m
        pid_1 = inner_2d_pid % num_pid_in_group // group_size_m
        offset_0 = pid_0 * _BLOCK_SIZE_0
        indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
        mask_0 = indices_0 < x_flat_size_0
        offset_1 = pid_1 * _BLOCK_SIZE_1
        indices_1 = (offset_1 + tl.arange(0, _BLOCK_SIZE_1)).to(tl.int32)
        mask_1 = indices_1 < embedding_dim
        load = tl.load(tl.make_block_ptr(x_flat, [x_flat_size_0], [x_flat_stride_0], [offset_0], [_BLOCK_SIZE_0], [0]), boundary_check=[0], padding_option='zero')
        load_1 = tl.load(weight + (load[:, None] * weight_stride_0 + indices_1[None, :] * weight_stride_1), mask_0[:, None] & mask_1[None, :], other=0)
                                   ^
ValueError('numel (2097152) exceeds triton maximum tensor numel (1048576)')
[479s] Generation 7: replaced=8 min=0.2210 mid=0.2480 max=0.2622 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[519s] Generation 8: replaced=3 min=0.2210 mid=0.2478 max=0.2622 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[571s] Generation 9: replaced=10 min=0.2210 mid=0.2472 max=0.2556 best=Config(block_sizes=[128, 64], loop_orders=[[1, 0]], l2_groupings=[4], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[636s] Timeout after 60s compiling Config(block_sizes=[256, 2048], loop_orders=[[0, 1]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[666s] Generation 10: replaced=6 min=0.2196 mid=0.2428 max=0.2556 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-43364:
Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 18:31:
    first_pid_m = group_id * 64
    group_size_m = min(num_pid_m - first_pid_m, 64)
    pid_0 = first_pid_m + inner_2d_pid % num_pid_in_group % group_size_m
    pid_1 = inner_2d_pid % num_pid_in_group // group_size_m
    offset_0 = pid_0 * _BLOCK_SIZE_0
    indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
    mask_0 = indices_0 < x_flat_size_0
    offset_1 = pid_1 * _BLOCK_SIZE_1
    indices_1 = (offset_1 + tl.arange(0, _BLOCK_SIZE_1)).to(tl.int32)
    mask_1 = indices_1 < embedding_dim
    load = tl.load(x_flat + indices_0 * x_flat_stride_0, mask_0, other=0)
    load_1 = tl.load(weight + (load[:, None] * weight_stride_0 + indices_1[None, :] * weight_stride_1), mask_0[:, None] & mask_1[None, :], other=0)
                               ^
ValueError('numel (4194304) exceeds triton maximum tensor numel (1048576)')
[733s] Timeout after 60s compiling Config(block_sizes=[256, 4096], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[1], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[True], num_warps=4, num_stages=1, indexing='pointer', pid_type='persistent_interleaved')
[780s] Generation 11: replaced=9 min=0.2196 mid=0.2361 max=0.2527 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[841s] Timeout after 60s compiling Config(block_sizes=[512, 1024], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[1], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='persistent_interleaved')
[961s] Timeout after 60s compiling Config(block_sizes=[128, 4096], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[964s] Generation 12: replaced=9 min=0.2196 mid=0.2355 max=0.2522 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1071s] Generation 13: replaced=8 min=0.2196 mid=0.2343 max=0.2516 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1111s] Generation 14: replaced=6 min=0.2196 mid=0.2341 max=0.2516 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-43736:
Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 18:31:
    first_pid_m = group_id * 16
    group_size_m = min(num_pid_m - first_pid_m, 16)
    pid_0 = first_pid_m + inner_2d_pid % num_pid_in_group % group_size_m
    pid_1 = inner_2d_pid % num_pid_in_group // group_size_m
    offset_0 = pid_0 * _BLOCK_SIZE_0
    indices_0 = (offset_0 + tl.arange(0, _BLOCK_SIZE_0)).to(tl.int32)
    mask_0 = indices_0 < x_flat_size_0
    offset_1 = pid_1 * _BLOCK_SIZE_1
    indices_1 = (offset_1 + tl.arange(0, _BLOCK_SIZE_1)).to(tl.int32)
    mask_1 = indices_1 < embedding_dim
    load = tl.load(x_flat + indices_0 * x_flat_stride_0, mask_0, other=0)
    load_1 = tl.load(weight + (load[:, None] * weight_stride_0 + indices_1[None, :] * weight_stride_1), mask_0[:, None] & mask_1[None, :], other=0)
                               ^
ValueError('numel (2097152) exceeds triton maximum tensor numel (1048576)')
[1176s] Generation 15: replaced=5 min=0.2196 mid=0.2329 max=0.2499 best=Config(block_sizes=[512, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1268s] Generation 16: replaced=11 min=0.2177 mid=0.2250 max=0.2493 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1348s] Timeout after 60s compiling Config(block_sizes=[512, 1024], loop_orders=[[0, 1]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1363s] Generation 17: replaced=6 min=0.2177 mid=0.2248 max=0.2478 best=Config(block_sizes=[32, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1411s] Generation 18: replaced=9 min=0.2145 mid=0.2217 max=0.2471 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1464s] Generation 19: replaced=12 min=0.2145 mid=0.2212 max=0.2422 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1464s] Autotuning complete in 1464.4s after searching 1510 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 81%|████████▏ | 13/16 [3:39:04<59:45, 1195.02s/it]  INFO:tritonbench.utils.triton_op:Took 612.32ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 611.91ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 614.41ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.93ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 3 outliers from 304 samples
Removed 2 outliers from 279 samples
Removed 11 outliers from 284 samples
Removed 1 outliers from 260 samples
[34s] Initial population: failed=7 min=0.2512 mid=0.6355 max=58.4027 best=Config(block_sizes=[32, 32], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[98s] Generation 2: replaced=17 min=0.2397 mid=0.2822 max=0.6586 best=Config(block_sizes=[16, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[150s] Generation 3: replaced=13 min=0.2397 mid=0.2626 max=0.6341 best=Config(block_sizes=[16, 64], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[199s] Generation 4: replaced=16 min=0.2388 mid=0.2587 max=0.6341 best=Config(block_sizes=[16, 128], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[236s] Generation 5: replaced=13 min=0.2359 mid=0.2563 max=0.3811 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[273s] Generation 6: replaced=8 min=0.2359 mid=0.2562 max=0.2874 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[335s] Timeout after 60s compiling Config(block_sizes=[1024, 256], loop_orders=[[1, 0]], l2_groupings=[16], range_unroll_factors=[1], range_num_stages=[4], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='pointer', pid_type='persistent_interleaved')
[364s] Generation 7: replaced=10 min=0.2359 mid=0.2526 max=0.2874 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[429s] Timeout after 60s compiling Config(block_sizes=[1024, 256], loop_orders=[[1, 0]], l2_groupings=[8], range_unroll_factors=[1], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=4, indexing='pointer', pid_type='persistent_interleaved')
[478s] Generation 8: replaced=14 min=0.2359 mid=0.2512 max=0.2686 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[556s] Generation 9: replaced=11 min=0.2359 mid=0.2473 max=0.2591 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[599s] Generation 10: replaced=11 min=0.2359 mid=0.2444 max=0.2571 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[639s] Generation 11: replaced=15 min=0.2351 mid=0.2400 max=0.2571 best=Config(block_sizes=[64, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[672s] Generation 12: replaced=8 min=0.2341 mid=0.2398 max=0.2571 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[705s] Generation 13: replaced=5 min=0.2341 mid=0.2398 max=0.2560 best=Config(block_sizes=[16, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[775s] Generation 14: replaced=13 min=0.2328 mid=0.2394 max=0.2529 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[811s] Generation 15: replaced=9 min=0.2328 mid=0.2388 max=0.2517 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[855s] Generation 16: replaced=6 min=0.2328 mid=0.2387 max=0.2517 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[889s] Generation 17: replaced=8 min=0.2328 mid=0.2385 max=0.2496 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[921s] Generation 18: replaced=6 min=0.2328 mid=0.2367 max=0.2496 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[950s] Generation 19: replaced=13 min=0.2328 mid=0.2359 max=0.2398 best=Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[950s] Autotuning complete in 950.8s after searching 1518 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 88%|████████▊ | 14/16 [3:54:58<37:24, 1122.27s/it]INFO:tritonbench.utils.triton_op:Took 1229.21ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 1228.61ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 1243.72ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.78ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 9 outliers from 288 samples
Removed 1 outliers from 277 samples
Removed 9 outliers from 274 samples
Removed 3 outliers from 260 samples
[40s] Initial population: failed=13 min=0.2524 mid=0.7129 max=64.4639 best=Config(block_sizes=[2, 256], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-45682:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 2304, in make_tensor_descriptor
    return _semantic.make_tensor_descriptor(base, shape, strides, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 1880, in make_tensor_descriptor
    type = tl.block_type(base.type.element_ty, block_shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (4194304) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 2:15:
def _embedding_kernel(x_flat, weight, out, out_size_0, out_size_1, x_flat_size_0, out_stride_0, out_stride_1, weight_stride_0, weight_stride_1, x_flat_stride_0, embedding_dim, _BLOCK_SIZE_0: tl.constexpr, _BLOCK_SIZE_1: tl.constexpr):
    out_desc = tl.make_tensor_descriptor(out, [out_size_0, out_size_1], [out_stride_0, out_stride_1], [_BLOCK_SIZE_0, _BLOCK_SIZE_1])
               ^
[77s] Generation 2: replaced=18 min=0.2524 mid=0.2875 max=0.8142 best=Config(block_sizes=[2, 256], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[136s] Generation 3: replaced=16 min=0.2502 mid=0.2723 max=0.5988 best=Config(block_sizes=[1, 512], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[208s] Generation 4: replaced=15 min=0.2440 mid=0.2603 max=0.5119 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[248s] Generation 5: replaced=17 min=0.2440 mid=0.2558 max=0.3500 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[347s] Timeout after 60s compiling Config(block_sizes=[1024, 512], loop_orders=[[0, 1]], l2_groupings=[2], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[False], num_warps=4, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[357s] Generation 6: replaced=15 min=0.2440 mid=0.2537 max=0.2859 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[392s] Generation 7: replaced=12 min=0.2440 mid=0.2531 max=0.2752 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[428s] Generation 8: replaced=15 min=0.2440 mid=0.2525 max=0.2646 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[465s] Generation 9: replaced=17 min=0.2437 mid=0.2510 max=0.2567 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[497s] Generation 10: replaced=15 min=0.2437 mid=0.2490 max=0.2567 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[528s] Generation 11: replaced=6 min=0.2437 mid=0.2490 max=0.2553 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[561s] Generation 12: replaced=9 min=0.2437 mid=0.2477 max=0.2527 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[595s] Generation 13: replaced=6 min=0.2437 mid=0.2474 max=0.2527 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[628s] Generation 14: replaced=5 min=0.2437 mid=0.2468 max=0.2527 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[656s] Generation 15: replaced=15 min=0.2436 mid=0.2449 max=0.2527 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat')
[685s] Generation 16: replaced=10 min=0.2436 mid=0.2446 max=0.2527 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat')
[714s] Generation 17: replaced=8 min=0.2436 mid=0.2443 max=0.2527 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat')
[742s] Generation 18: replaced=12 min=0.2436 mid=0.2443 max=0.2481 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat')
[769s] Generation 19: replaced=15 min=0.2436 mid=0.2442 max=0.2481 best=Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat')
[769s] Autotuning complete in 769.8s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat'))

 94%|█████████▍| 15/16 [4:07:53<16:57, 1017.78s/it]INFO:tritonbench.utils.triton_op:Took 2519.10ms to get benchmark function for torch_embedding
INFO:tritonbench.utils.triton_op:Took 2483.07ms to get benchmark function for liger_embedding
INFO:tritonbench.utils.triton_op:Took 2504.80ms to get benchmark function for inductor_embedding
INFO:tritonbench.utils.triton_op:Took 5.33ms to get benchmark function for helion_embedding
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 2 outliers from 278 samples
Removed 6 outliers from 268 samples
Removed 2 outliers from 261 samples
[53s] Initial population: failed=8 min=0.2575 mid=1.1517 max=146.5350 best=Config(block_sizes=[16, 128], loop_orders=[[0, 1]], l2_groupings=[16], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[131s] Timeout after 60s compiling Config(block_sizes=[16384, 16], loop_orders=[[1, 0]], l2_groupings=[32], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[True], num_warps=8, num_stages=8, indexing='pointer', pid_type='persistent_blocked')
[210s] Timeout after 60s compiling Config(block_sizes=[16384, 16], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[1], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=8, indexing='pointer', pid_type='persistent_blocked')
[216s] Generation 2: replaced=22 min=0.2550 mid=0.2706 max=1.1928 best=Config(block_sizes=[2, 1024], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[316s] Timeout after 60s compiling Config(block_sizes=[512, 256], loop_orders=[[0, 1]], l2_groupings=[2], range_unroll_factors=[3], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[None], num_warps=1, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[320s] Generation 3: replaced=17 min=0.2549 mid=0.2657 max=0.4445 best=Config(block_sizes=[2, 256], loop_orders=[[0, 1]], l2_groupings=[8], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[363s] Generation 4: replaced=17 min=0.2546 mid=0.2607 max=0.3176 best=Config(block_sizes=[1, 2048], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[425s] Timeout after 60s compiling Config(block_sizes=[128, 2048], loop_orders=[[1, 0]], l2_groupings=[64], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[None], num_warps=4, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[460s] Generation 5: replaced=15 min=0.2543 mid=0.2582 max=0.2701 best=Config(block_sizes=[32, 1024], loop_orders=[[0, 1]], l2_groupings=[32], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[502s] Generation 6: replaced=14 min=0.2539 mid=0.2563 max=0.2701 best=Config(block_sizes=[32, 1024], loop_orders=[[1, 0]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[560s] Generation 7: replaced=12 min=0.2534 mid=0.2556 max=0.2685 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[598s] Generation 8: replaced=13 min=0.2528 mid=0.2549 max=0.2685 best=Config(block_sizes=[128, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[643s] Generation 9: replaced=5 min=0.2528 mid=0.2548 max=0.2685 best=Config(block_sizes=[128, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[677s] Generation 10: replaced=12 min=0.2528 mid=0.2545 max=0.2648 best=Config(block_sizes=[128, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[742s] Timeout after 60s compiling Config(block_sizes=[128, 2048], loop_orders=[[0, 1]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[774s] Generation 11: replaced=8 min=0.2528 mid=0.2544 max=0.2648 best=Config(block_sizes=[128, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[837s] Timeout after 60s compiling Config(block_sizes=[64, 4096], loop_orders=[[1, 0]], l2_groupings=[64], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[867s] Generation 12: replaced=11 min=0.2528 mid=0.2544 max=0.2614 best=Config(block_sizes=[128, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[907s] Generation 13: replaced=5 min=0.2528 mid=0.2544 max=0.2614 best=Config(block_sizes=[128, 256], loop_orders=[[1, 0]], l2_groupings=[2], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[957s] Generation 14: replaced=7 min=0.2524 mid=0.2542 max=0.2555 best=Config(block_sizes=[64, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1040s] Generation 15: replaced=6 min=0.2524 mid=0.2542 max=0.2555 best=Config(block_sizes=[64, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1075s] Generation 16: replaced=4 min=0.2512 mid=0.2541 max=0.2552 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1116s] Generation 17: replaced=7 min=0.2511 mid=0.2540 max=0.2552 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1159s] Generation 18: replaced=5 min=0.2511 mid=0.2540 max=0.2549 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1196s] Generation 19: replaced=6 min=0.2511 mid=0.2539 max=0.2549 best=Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[1196s] Autotuning complete in 1196.8s after searching 1514 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[128, 256], loop_orders=[[0, 1]], l2_groupings=[1], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

100%|██████████| 16/16 [4:28:01<00:00, 1074.93s/it]100%|██████████| 16/16 [4:28:01<00:00, 1005.10s/it]

Benchmark Results:
           (B, T, D, V)    liger_embedding-speedup    inductor_embedding-speedup    helion_embedding-speedup
-----------------------  -------------------------  ----------------------------  --------------------------
   (32, 512, 768, 1024)                   0.960997                      1.00453                      0.99217
   (32, 512, 768, 2048)                   1.04273                       1.0364                       1.04167
   (32, 512, 768, 4096)                   1.05753                       1.01937                      1.08732
   (32, 512, 768, 8192)                   1.07804                       1.01285                      1.09567
  (32, 512, 768, 16384)                   1.06335                       1.0191                       1.08497
  (32, 512, 768, 32768)                   1.03274                       1.01742                      1.04784
  (32, 512, 768, 65536)                   1.00306                       1.00861                      1.05534
 (32, 512, 768, 131072)                   1.00121                       1.01528                      1.04269
  (8, 2048, 4096, 1024)                   0.958173                      0.777757                     1.02814
  (8, 2048, 4096, 2048)                   1.02893                       0.763178                     1.07185
  (8, 2048, 4096, 4096)                   1.08525                       0.804278                     1.10369
  (8, 2048, 4096, 8192)                   1.09378                       0.879622                     1.11199
 (8, 2048, 4096, 16384)                   1.05506                       0.935305                     1.08088
 (8, 2048, 4096, 32768)                   1.02866                       0.970674                     1.05143
 (8, 2048, 4096, 65536)                   0.998209                      0.988972                     1.02442
(8, 2048, 4096, 131072)                   0.978515                      0.995075                     1.00267
                average                   1.02914                       0.953026                     1.05767

============================================================
Kernel: vector_exp
============================================================

Running vector_exp benchmark with Helion implementation...

  0%|          | 0/16 [00:00<?, ?it/s]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.09ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
[24s] Initial population: min=0.0045 mid=0.0051 max=0.0105 best=Config(block_sizes=[128], range_unroll_factors=[1], range_num_stages=[0], range_multi_buffers=[False], range_flattens=[True], num_warps=2, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[57s] Generation 2: replaced=16 min=0.0045 mid=0.0047 max=0.0050 best=Config(block_sizes=[128], range_unroll_factors=[1], range_num_stages=[0], range_multi_buffers=[False], range_flattens=[True], num_warps=2, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[90s] Generation 3: replaced=9 min=0.0045 mid=0.0046 max=0.0050 best=Config(block_sizes=[128], range_unroll_factors=[1], range_num_stages=[0], range_multi_buffers=[False], range_flattens=[True], num_warps=2, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[121s] Generation 4: replaced=10 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[153s] Generation 5: replaced=6 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[183s] Generation 6: replaced=1 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[215s] Generation 7: replaced=7 min=0.0045 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[245s] Generation 8: replaced=3 min=0.0045 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[275s] Generation 9: replaced=3 min=0.0045 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[304s] Generation 10: replaced=4 min=0.0045 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[334s] Generation 11: replaced=4 min=0.0045 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[364s] Generation 12: replaced=2 min=0.0045 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[392s] Generation 13: replaced=5 min=0.0045 mid=0.0045 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[423s] Generation 14: replaced=2 min=0.0045 mid=0.0045 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[451s] Generation 15: replaced=5 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[480s] Generation 16: replaced=4 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[506s] Generation 17: replaced=0 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[534s] Generation 18: replaced=3 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[561s] Generation 19: replaced=0 min=0.0045 mid=0.0045 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat')
[561s] Autotuning complete in 561.8s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[256], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat'))

  6%|▋         | 1/16 [09:22<2:20:36, 562.41s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 3.75ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
[20s] Initial population: min=0.0045 mid=0.0051 max=0.0192 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[50s] Generation 2: replaced=11 min=0.0045 mid=0.0046 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[82s] Generation 3: replaced=6 min=0.0045 mid=0.0046 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[111s] Generation 4: replaced=12 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[140s] Generation 5: replaced=11 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[169s] Generation 6: replaced=1 min=0.0045 mid=0.0046 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[197s] Generation 7: replaced=2 min=0.0045 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[224s] Generation 8: replaced=4 min=0.0045 mid=0.0046 max=0.0048 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[251s] Generation 9: replaced=3 min=0.0045 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[278s] Generation 10: replaced=2 min=0.0045 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[305s] Generation 11: replaced=4 min=0.0045 mid=0.0046 max=0.0047 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[331s] Generation 12: replaced=6 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[357s] Generation 13: replaced=5 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[385s] Generation 14: replaced=2 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[410s] Generation 15: replaced=3 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[435s] Generation 16: replaced=4 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[459s] Generation 17: replaced=4 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[485s] Generation 18: replaced=0 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[510s] Generation 19: replaced=1 min=0.0045 mid=0.0046 max=0.0046 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[510s] Autotuning complete in 510.1s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 12%|█▎        | 2/16 [17:52<2:04:05, 531.83s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 3.11ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 6 outliers from 814 samples
[23s] Initial population: failed=2 min=0.0047 mid=0.0056 max=0.0455 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[55s] Generation 2: replaced=22 min=0.0047 mid=0.0049 max=0.0055 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[87s] Generation 3: replaced=3 min=0.0047 mid=0.0049 max=0.0055 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[117s] Generation 4: replaced=13 min=0.0046 mid=0.0048 max=0.0051 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[146s] Generation 5: replaced=10 min=0.0046 mid=0.0047 max=0.0051 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[176s] Generation 6: replaced=16 min=0.0046 mid=0.0047 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[203s] Generation 7: replaced=2 min=0.0046 mid=0.0047 max=0.0049 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[231s] Generation 8: replaced=6 min=0.0046 mid=0.0047 max=0.0048 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[259s] Generation 9: replaced=4 min=0.0046 mid=0.0047 max=0.0048 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[288s] Generation 10: replaced=6 min=0.0046 mid=0.0047 max=0.0048 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[316s] Generation 11: replaced=7 min=0.0046 mid=0.0047 max=0.0048 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[343s] Generation 12: replaced=5 min=0.0046 mid=0.0047 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[370s] Generation 13: replaced=3 min=0.0046 mid=0.0047 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[397s] Generation 14: replaced=3 min=0.0046 mid=0.0047 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[422s] Generation 15: replaced=0 min=0.0046 mid=0.0047 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[448s] Generation 16: replaced=5 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[472s] Generation 17: replaced=1 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[497s] Generation 18: replaced=4 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[523s] Generation 19: replaced=0 min=0.0046 mid=0.0046 max=0.0047 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[523s] Autotuning complete in 523.5s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat'))

 19%|█▉        | 3/16 [26:36<1:54:26, 528.17s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.09ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 2.68ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 16 outliers from 847 samples
[36s] Initial population: failed=3 min=0.0048 mid=0.0058 max=0.0523 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[65s] Generation 2: replaced=22 min=0.0048 mid=0.0049 max=0.0056 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[98s] Generation 3: replaced=12 min=0.0048 mid=0.0048 max=0.0055 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[132s] Generation 4: replaced=10 min=0.0048 mid=0.0048 max=0.0052 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[165s] Generation 5: replaced=9 min=0.0048 mid=0.0048 max=0.0051 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[199s] Generation 6: replaced=6 min=0.0048 mid=0.0048 max=0.0051 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[231s] Generation 7: replaced=4 min=0.0048 mid=0.0048 max=0.0051 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[265s] Generation 8: replaced=5 min=0.0048 mid=0.0048 max=0.0049 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[298s] Generation 9: replaced=2 min=0.0048 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=7, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[331s] Generation 10: replaced=3 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[363s] Generation 11: replaced=1 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[394s] Generation 12: replaced=4 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[426s] Generation 13: replaced=3 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[458s] Generation 14: replaced=1 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[491s] Generation 15: replaced=2 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[523s] Generation 16: replaced=1 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[555s] Generation 17: replaced=2 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat')
[588s] Generation 18: replaced=0 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat')
[620s] Generation 19: replaced=1 min=0.0047 mid=0.0048 max=0.0048 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat')
[620s] Autotuning complete in 620.4s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat'))

 25%|██▌       | 4/16 [36:57<1:52:56, 564.70s/it]INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.11ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 4.11ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 6 outliers from 793 samples
Removed 19 outliers from 824 samples
Removed 11 outliers from 822 samples
[31s] Initial population: failed=5 min=0.0049 mid=0.0068 max=0.3772 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[62s] Generation 2: replaced=19 min=0.0049 mid=0.0051 max=0.0068 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[94s] Generation 3: replaced=14 min=0.0049 mid=0.0050 max=0.0057 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[126s] Generation 4: replaced=9 min=0.0049 mid=0.0049 max=0.0057 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[154s] Generation 5: replaced=12 min=0.0049 mid=0.0049 max=0.0057 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[185s] Generation 6: replaced=5 min=0.0048 mid=0.0049 max=0.0057 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[214s] Generation 7: replaced=9 min=0.0048 mid=0.0049 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[246s] Generation 8: replaced=2 min=0.0048 mid=0.0049 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[277s] Generation 9: replaced=3 min=0.0048 mid=0.0049 max=0.0053 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[308s] Generation 10: replaced=5 min=0.0048 mid=0.0049 max=0.0051 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[336s] Generation 11: replaced=9 min=0.0048 mid=0.0049 max=0.0050 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[362s] Generation 12: replaced=3 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[388s] Generation 13: replaced=1 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[413s] Generation 14: replaced=2 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[438s] Generation 15: replaced=2 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[463s] Generation 16: replaced=3 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[488s] Generation 17: replaced=3 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[515s] Generation 18: replaced=4 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[541s] Generation 19: replaced=2 min=0.0048 mid=0.0049 max=0.0049 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[541s] Autotuning complete in 541.8s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 31%|███▏      | 5/16 [45:59<1:42:02, 556.57s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 3.05ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 5 outliers from 844 samples
[20s] Initial population: failed=1 min=0.0050 mid=0.0076 max=0.3296 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[51s] Generation 2: replaced=15 min=0.0050 mid=0.0054 max=0.0076 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[80s] Generation 3: replaced=15 min=0.0050 mid=0.0052 max=0.0067 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[110s] Generation 4: replaced=9 min=0.0050 mid=0.0052 max=0.0061 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[140s] Generation 5: replaced=11 min=0.0050 mid=0.0051 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[168s] Generation 6: replaced=13 min=0.0050 mid=0.0051 max=0.0055 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[198s] Generation 7: replaced=6 min=0.0050 mid=0.0051 max=0.0055 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[228s] Generation 8: replaced=7 min=0.0050 mid=0.0051 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[257s] Generation 9: replaced=6 min=0.0050 mid=0.0051 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[285s] Generation 10: replaced=5 min=0.0050 mid=0.0051 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[313s] Generation 11: replaced=6 min=0.0050 mid=0.0050 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[342s] Generation 12: replaced=2 min=0.0050 mid=0.0050 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[375s] Generation 13: replaced=2 min=0.0050 mid=0.0050 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[409s] Generation 14: replaced=4 min=0.0050 mid=0.0050 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[442s] Generation 15: replaced=1 min=0.0050 mid=0.0050 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[475s] Generation 16: replaced=2 min=0.0050 mid=0.0050 max=0.0052 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[502s] Generation 17: replaced=3 min=0.0050 mid=0.0050 max=0.0051 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[531s] Generation 18: replaced=2 min=0.0050 mid=0.0050 max=0.0051 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[559s] Generation 19: replaced=1 min=0.0050 mid=0.0050 max=0.0051 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat')
[559s] Autotuning complete in 559.1s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=6, indexing='block_ptr', pid_type='flat'))

 38%|███▊      | 6/16 [55:18<1:32:55, 557.54s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 3.28ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 1 outliers from 845 samples
[29s] Initial population: failed=3 min=0.0055 mid=0.0081 max=0.6479 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[66s] Generation 2: replaced=11 min=0.0055 mid=0.0063 max=0.0080 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[97s] Generation 3: replaced=14 min=0.0055 mid=0.0060 max=0.0076 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[130s] Generation 4: replaced=11 min=0.0055 mid=0.0060 max=0.0076 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[162s] Generation 5: replaced=15 min=0.0055 mid=0.0058 max=0.0061 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[196s] Generation 6: replaced=12 min=0.0055 mid=0.0058 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[225s] Generation 7: replaced=9 min=0.0055 mid=0.0057 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[255s] Generation 8: replaced=6 min=0.0055 mid=0.0057 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[287s] Generation 9: replaced=5 min=0.0055 mid=0.0057 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[316s] Generation 10: replaced=9 min=0.0055 mid=0.0057 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[341s] Generation 11: replaced=6 min=0.0055 mid=0.0057 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[368s] Generation 12: replaced=4 min=0.0055 mid=0.0056 max=0.0060 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[395s] Generation 13: replaced=6 min=0.0055 mid=0.0056 max=0.0059 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[424s] Generation 14: replaced=4 min=0.0055 mid=0.0056 max=0.0058 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[451s] Generation 15: replaced=7 min=0.0055 mid=0.0056 max=0.0057 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[476s] Generation 16: replaced=5 min=0.0055 mid=0.0056 max=0.0057 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[502s] Generation 17: replaced=6 min=0.0055 mid=0.0056 max=0.0057 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[526s] Generation 18: replaced=6 min=0.0055 mid=0.0056 max=0.0057 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[551s] Generation 19: replaced=3 min=0.0055 mid=0.0055 max=0.0057 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[551s] Autotuning complete in 551.7s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 44%|████▍     | 7/16 [1:04:30<1:23:21, 555.74s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 2.56ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 4 outliers from 824 samples
Removed 30 outliers from 833 samples
Removed 3 outliers from 823 samples
[63s] Timeout after 60s compiling Config(block_sizes=[262144], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[True], range_flattens=[None], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='persistent_blocked')
[69s] Timeout after 60s compiling Config(block_sizes=[262144], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[False], num_warps=4, num_stages=6, indexing='tensor_descriptor', pid_type='persistent_blocked')
[78s] Initial population: failed=5 min=0.0067 mid=0.0100 max=0.7911 best=Config(block_sizes=[4096], range_unroll_factors=[4], range_num_stages=[1], range_multi_buffers=[True], range_flattens=[None], num_warps=8, num_stages=3, indexing='pointer', pid_type='persistent_interleaved')
[116s] Generation 2: replaced=18 min=0.0067 mid=0.0071 max=0.0096 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[150s] Generation 3: replaced=14 min=0.0067 mid=0.0069 max=0.0090 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[180s] Generation 4: replaced=14 min=0.0067 mid=0.0068 max=0.0075 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[213s] Generation 5: replaced=10 min=0.0067 mid=0.0068 max=0.0074 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[248s] Generation 6: replaced=5 min=0.0067 mid=0.0068 max=0.0072 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[280s] Generation 7: replaced=6 min=0.0067 mid=0.0068 max=0.0071 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[320s] Generation 8: replaced=3 min=0.0067 mid=0.0068 max=0.0071 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[353s] Generation 9: replaced=4 min=0.0067 mid=0.0067 max=0.0070 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[387s] Generation 10: replaced=3 min=0.0067 mid=0.0067 max=0.0070 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[420s] Generation 11: replaced=4 min=0.0067 mid=0.0067 max=0.0070 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[450s] Generation 12: replaced=4 min=0.0067 mid=0.0067 max=0.0070 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[479s] Generation 13: replaced=6 min=0.0067 mid=0.0067 max=0.0068 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[508s] Generation 14: replaced=1 min=0.0067 mid=0.0067 max=0.0068 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[536s] Generation 15: replaced=3 min=0.0067 mid=0.0067 max=0.0068 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[563s] Generation 16: replaced=2 min=0.0067 mid=0.0067 max=0.0068 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[590s] Generation 17: replaced=3 min=0.0067 mid=0.0067 max=0.0068 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[619s] Generation 18: replaced=5 min=0.0067 mid=0.0067 max=0.0068 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[645s] Generation 19: replaced=2 min=0.0067 mid=0.0067 max=0.0068 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[645s] Autotuning complete in 645.2s after searching 1518 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 50%|█████     | 8/16 [1:15:16<1:17:54, 584.32s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.09ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 3.62ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 17 outliers from 822 samples
Removed 24 outliers from 799 samples
[61s] Initial population: failed=5 min=0.0088 mid=0.0148 max=1.2884 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[119s] Generation 2: replaced=13 min=0.0088 mid=0.0094 max=0.0157 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[165s] Generation 3: replaced=16 min=0.0086 mid=0.0093 max=0.0142 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[204s] Generation 4: replaced=12 min=0.0086 mid=0.0090 max=0.0113 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[244s] Generation 5: replaced=10 min=0.0086 mid=0.0090 max=0.0098 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[276s] Generation 6: replaced=13 min=0.0086 mid=0.0089 max=0.0097 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[310s] Generation 7: replaced=9 min=0.0086 mid=0.0089 max=0.0094 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[347s] Generation 8: replaced=10 min=0.0086 mid=0.0088 max=0.0092 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[384s] Generation 9: replaced=5 min=0.0086 mid=0.0088 max=0.0092 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=16, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[412s] Generation 10: replaced=2 min=0.0086 mid=0.0088 max=0.0092 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[True], num_warps=16, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[447s] Generation 11: replaced=5 min=0.0086 mid=0.0088 max=0.0092 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[True], num_warps=16, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[483s] Generation 12: replaced=6 min=0.0086 mid=0.0088 max=0.0092 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[True], num_warps=16, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[517s] Generation 13: replaced=5 min=0.0086 mid=0.0088 max=0.0090 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[True], num_warps=16, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[551s] Generation 14: replaced=5 min=0.0086 mid=0.0088 max=0.0090 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved')
[582s] Generation 15: replaced=2 min=0.0086 mid=0.0088 max=0.0090 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved')
[610s] Generation 16: replaced=4 min=0.0086 mid=0.0088 max=0.0089 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved')
[637s] Generation 17: replaced=0 min=0.0086 mid=0.0088 max=0.0089 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved')
[667s] Generation 18: replaced=1 min=0.0086 mid=0.0088 max=0.0089 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved')
[697s] Generation 19: replaced=0 min=0.0086 mid=0.0088 max=0.0089 best=Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved')
[697s] Autotuning complete in 697.1s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4096], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[None], range_flattens=[True], num_warps=8, num_stages=7, indexing='block_ptr', pid_type='persistent_interleaved'))

 56%|█████▋    | 9/16 [1:26:53<1:12:17, 619.69s/it]INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.12ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 4.22ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 19 outliers from 747 samples
Removed 22 outliers from 794 samples
Removed 1 outliers from 784 samples
[72s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[2], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=5, indexing='tensor_descriptor', pid_type='persistent_blocked')
[80s] Initial population: failed=6 min=0.0118 mid=0.0268 max=1.6703 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[122s] Generation 2: replaced=20 min=0.0118 mid=0.0133 max=0.0268 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[154s] Generation 3: replaced=15 min=0.0118 mid=0.0131 max=0.0206 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[185s] Generation 4: replaced=12 min=0.0117 mid=0.0126 max=0.0151 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[222s] Generation 5: replaced=13 min=0.0117 mid=0.0124 max=0.0138 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[254s] Generation 6: replaced=8 min=0.0117 mid=0.0122 max=0.0136 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[286s] Generation 7: replaced=15 min=0.0117 mid=0.0120 max=0.0136 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[344s] Generation 8: replaced=9 min=0.0117 mid=0.0119 max=0.0131 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[374s] Generation 9: replaced=11 min=0.0117 mid=0.0119 max=0.0125 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[409s] Generation 10: replaced=6 min=0.0117 mid=0.0118 max=0.0125 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[437s] Generation 11: replaced=7 min=0.0117 mid=0.0118 max=0.0122 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[467s] Generation 12: replaced=3 min=0.0117 mid=0.0118 max=0.0121 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[493s] Generation 13: replaced=4 min=0.0117 mid=0.0118 max=0.0120 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[519s] Generation 14: replaced=3 min=0.0117 mid=0.0118 max=0.0120 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat')
[545s] Generation 15: replaced=9 min=0.0117 mid=0.0118 max=0.0120 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[570s] Generation 16: replaced=3 min=0.0117 mid=0.0118 max=0.0120 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[596s] Generation 17: replaced=4 min=0.0117 mid=0.0118 max=0.0120 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[621s] Generation 18: replaced=0 min=0.0117 mid=0.0118 max=0.0120 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[647s] Generation 19: replaced=1 min=0.0117 mid=0.0118 max=0.0119 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[647s] Autotuning complete in 647.1s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='flat', range_warp_specializes=[]))

 62%|██████▎   | 10/16 [1:37:41<1:02:49, 628.27s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 2.78ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 1 outliers from 783 samples
Removed 2 outliers from 748 samples
Removed 9 outliers from 741 samples
[34s] Initial population: failed=2 min=0.0183 mid=0.0521 max=10.3091 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[96s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[True], num_warps=2, num_stages=8, indexing='tensor_descriptor', pid_type='persistent_blocked')
[133s] Generation 2: replaced=19 min=0.0183 mid=0.0207 max=0.0440 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[175s] Generation 3: replaced=14 min=0.0183 mid=0.0195 max=0.0327 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[219s] Generation 4: replaced=13 min=0.0183 mid=0.0192 max=0.0263 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[255s] Generation 5: replaced=13 min=0.0183 mid=0.0191 max=0.0242 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[293s] Generation 6: replaced=12 min=0.0182 mid=0.0189 max=0.0197 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[332s] Generation 7: replaced=9 min=0.0182 mid=0.0188 max=0.0197 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[361s] Generation 8: replaced=10 min=0.0182 mid=0.0187 max=0.0192 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[387s] Generation 9: replaced=9 min=0.0182 mid=0.0187 max=0.0192 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[424s] Generation 10: replaced=8 min=0.0182 mid=0.0187 max=0.0192 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[451s] Generation 11: replaced=7 min=0.0182 mid=0.0186 max=0.0188 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[478s] Generation 12: replaced=6 min=0.0182 mid=0.0186 max=0.0188 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[504s] Generation 13: replaced=7 min=0.0182 mid=0.0186 max=0.0188 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[531s] Generation 14: replaced=7 min=0.0182 mid=0.0183 max=0.0188 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[557s] Generation 15: replaced=2 min=0.0182 mid=0.0183 max=0.0188 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[584s] Generation 16: replaced=8 min=0.0182 mid=0.0183 max=0.0187 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[610s] Generation 17: replaced=9 min=0.0182 mid=0.0183 max=0.0187 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[635s] Generation 18: replaced=5 min=0.0182 mid=0.0183 max=0.0187 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[663s] Generation 19: replaced=6 min=0.0182 mid=0.0183 max=0.0187 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat')
[663s] Autotuning complete in 663.4s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='pointer', pid_type='flat'))

 69%|██████▉   | 11/16 [1:48:45<53:15, 639.14s/it]  INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 2.40ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 9 outliers from 752 samples
Removed 13 outliers from 674 samples
Removed 7 outliers from 667 samples
[26s] Initial population: failed=7 min=0.0347 mid=0.0886 max=12.2889 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[65s] Generation 2: replaced=18 min=0.0347 mid=0.0368 max=0.0666 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[105s] Generation 3: replaced=19 min=0.0345 mid=0.0356 max=0.0470 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='block_ptr', pid_type='flat')
[139s] Generation 4: replaced=16 min=0.0343 mid=0.0351 max=0.0459 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[182s] Generation 5: replaced=15 min=0.0343 mid=0.0349 max=0.0401 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[213s] Generation 6: replaced=10 min=0.0343 mid=0.0348 max=0.0389 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=4, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[242s] Generation 7: replaced=19 min=0.0342 mid=0.0346 max=0.0361 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='block_ptr', pid_type='flat')
[269s] Generation 8: replaced=11 min=0.0342 mid=0.0345 max=0.0357 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[299s] Generation 9: replaced=8 min=0.0342 mid=0.0345 max=0.0354 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[326s] Generation 10: replaced=6 min=0.0342 mid=0.0344 max=0.0351 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[354s] Generation 11: replaced=5 min=0.0342 mid=0.0344 max=0.0350 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[381s] Generation 12: replaced=3 min=0.0342 mid=0.0344 max=0.0350 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[409s] Generation 13: replaced=5 min=0.0342 mid=0.0344 max=0.0348 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[435s] Generation 14: replaced=6 min=0.0342 mid=0.0344 max=0.0348 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[462s] Generation 15: replaced=2 min=0.0342 mid=0.0344 max=0.0348 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[489s] Generation 16: replaced=5 min=0.0342 mid=0.0343 max=0.0347 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[516s] Generation 17: replaced=5 min=0.0342 mid=0.0343 max=0.0346 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[546s] Generation 18: replaced=3 min=0.0342 mid=0.0343 max=0.0345 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[577s] Generation 19: replaced=6 min=0.0342 mid=0.0343 max=0.0344 best=Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat')
[577s] Autotuning complete in 577.6s after searching 1520 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1024], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat'))

 75%|███████▌  | 12/16 [1:58:23<41:22, 620.53s/it]INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.11ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 3.53ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 10 outliers from 658 samples
Removed 43 outliers from 558 samples
Removed 59 outliers from 545 samples
[67s] Timeout after 60s compiling Config(block_sizes=[524288], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[False], num_warps=16, num_stages=1, indexing='pointer', pid_type='persistent_blocked')
[76s] Initial population: failed=7 min=0.0648 mid=0.1224 max=42.2897 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[127s] Generation 2: replaced=20 min=0.0646 mid=0.0667 max=0.0986 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[159s] Generation 3: replaced=12 min=0.0646 mid=0.0660 max=0.0979 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[191s] Generation 4: replaced=13 min=0.0646 mid=0.0659 max=0.0718 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[224s] Generation 5: replaced=14 min=0.0645 mid=0.0655 max=0.0698 best=Config(block_sizes=[4096], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='pointer', pid_type='flat')
[251s] Generation 6: replaced=14 min=0.0644 mid=0.0653 max=0.0674 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[278s] Generation 7: replaced=15 min=0.0644 mid=0.0650 max=0.0661 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[306s] Generation 8: replaced=9 min=0.0644 mid=0.0650 max=0.0659 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[333s] Generation 9: replaced=8 min=0.0644 mid=0.0649 max=0.0659 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[359s] Generation 10: replaced=8 min=0.0644 mid=0.0648 max=0.0653 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[386s] Generation 11: replaced=8 min=0.0644 mid=0.0647 max=0.0652 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[412s] Generation 12: replaced=9 min=0.0644 mid=0.0646 max=0.0652 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[439s] Generation 13: replaced=3 min=0.0644 mid=0.0646 max=0.0652 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[466s] Generation 14: replaced=5 min=0.0644 mid=0.0646 max=0.0652 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[494s] Generation 15: replaced=6 min=0.0644 mid=0.0646 max=0.0650 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[523s] Generation 16: replaced=2 min=0.0644 mid=0.0646 max=0.0650 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[550s] Generation 17: replaced=4 min=0.0644 mid=0.0646 max=0.0650 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[582s] Generation 18: replaced=4 min=0.0644 mid=0.0645 max=0.0649 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[616s] Generation 19: replaced=6 min=0.0644 mid=0.0645 max=0.0649 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=8, indexing='tensor_descriptor', pid_type='flat')
[616s] Autotuning complete in 616.0s after searching 1519 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[2048], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=8, indexing='tensor_descriptor', pid_type='flat'))

 81%|████████▏ | 13/16 [2:08:39<30:57, 619.27s/it]INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.14ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 2.77ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 48 outliers from 544 samples
Removed 10 outliers from 412 samples
Removed 5 outliers from 405 samples
[64s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[0], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[False], num_warps=2, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[71s] Timeout after 60s compiling Config(block_sizes=[262144], range_unroll_factors=[3], range_num_stages=[4], range_multi_buffers=[False], range_flattens=[True], num_warps=8, num_stages=7, indexing='pointer', pid_type='persistent_interleaved')
[81s] Initial population: failed=12 min=0.1286 mid=0.3638 max=46.1420 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=6, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[143s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=4, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[176s] Generation 2: replaced=16 min=0.1284 mid=0.1336 max=0.3855 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[285s] Timeout after 60s compiling Config(block_sizes=[524288], range_unroll_factors=[3], range_num_stages=[1], range_multi_buffers=[False], range_flattens=[None], num_warps=8, num_stages=5, indexing='block_ptr', pid_type='persistent_interleaved')
[309s] Generation 3: replaced=16 min=0.1284 mid=0.1295 max=0.3751 best=Config(block_sizes=[8192], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[350s] Generation 4: replaced=12 min=0.1282 mid=0.1292 max=0.1477 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[410s] Generation 5: replaced=8 min=0.1282 mid=0.1291 max=0.1477 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=3, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[440s] Generation 6: replaced=13 min=0.1280 mid=0.1290 max=0.1333 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[469s] Generation 7: replaced=18 min=0.1280 mid=0.1289 max=0.1297 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[499s] Generation 8: replaced=12 min=0.1280 mid=0.1286 max=0.1295 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[537s] Generation 9: replaced=6 min=0.1280 mid=0.1286 max=0.1293 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[566s] Generation 10: replaced=7 min=0.1280 mid=0.1286 max=0.1293 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[596s] Generation 11: replaced=11 min=0.1280 mid=0.1285 max=0.1290 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[626s] Generation 12: replaced=5 min=0.1280 mid=0.1285 max=0.1290 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[654s] Generation 13: replaced=10 min=0.1280 mid=0.1284 max=0.1290 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[682s] Generation 14: replaced=5 min=0.1280 mid=0.1284 max=0.1289 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[710s] Generation 15: replaced=7 min=0.1280 mid=0.1283 max=0.1289 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[739s] Generation 16: replaced=6 min=0.1280 mid=0.1283 max=0.1289 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[768s] Generation 17: replaced=6 min=0.1279 mid=0.1283 max=0.1289 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='tensor_descriptor', pid_type='flat')
[806s] Generation 18: replaced=8 min=0.1279 mid=0.1283 max=0.1289 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='tensor_descriptor', pid_type='flat')
[833s] Generation 19: replaced=4 min=0.1279 mid=0.1283 max=0.1286 best=Config(block_sizes=[2048], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='tensor_descriptor', pid_type='flat')
[833s] Autotuning complete in 833.8s after searching 1516 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[2048], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=5, indexing='tensor_descriptor', pid_type='flat'))

 88%|████████▊ | 14/16 [2:22:33<22:48, 684.18s/it]INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.10ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 2.45ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 12 outliers from 410 samples
Removed 3 outliers from 274 samples
Removed 2 outliers from 271 samples
[63s] Timeout after 60s compiling Config(block_sizes=[524288], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[False], num_warps=8, num_stages=7, indexing='pointer', pid_type='persistent_blocked')
[75s] Initial population: failed=6 min=0.2491 mid=0.6479 max=89.1507 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[141s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[2], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[None], num_warps=1, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[211s] Generation 2: replaced=16 min=0.2491 mid=0.2653 max=0.6361 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[252s] Generation 3: replaced=19 min=0.2486 mid=0.2514 max=0.6361 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[333s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[1], range_num_stages=[1], range_multi_buffers=[True], range_flattens=[None], num_warps=1, num_stages=2, indexing='block_ptr', pid_type='persistent_blocked')
[376s] Generation 4: replaced=11 min=0.2486 mid=0.2511 max=0.3640 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='block_ptr', pid_type='flat')
[413s] Generation 5: replaced=13 min=0.2486 mid=0.2505 max=0.3459 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=8, indexing='block_ptr', pid_type='flat')
[444s] Generation 6: replaced=15 min=0.2485 mid=0.2503 max=0.2765 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat')
[473s] Generation 7: replaced=11 min=0.2485 mid=0.2500 max=0.2518 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='block_ptr', pid_type='flat')
[501s] Generation 8: replaced=11 min=0.2485 mid=0.2498 max=0.2518 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat')
[532s] Generation 9: replaced=14 min=0.2485 mid=0.2491 max=0.2503 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat')
[561s] Generation 10: replaced=8 min=0.2485 mid=0.2489 max=0.2503 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat')
[588s] Generation 11: replaced=9 min=0.2485 mid=0.2489 max=0.2501 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=7, indexing='pointer', pid_type='flat')
[615s] Generation 12: replaced=14 min=0.2485 mid=0.2488 max=0.2501 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[642s] Generation 13: replaced=11 min=0.2485 mid=0.2487 max=0.2500 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[671s] Generation 14: replaced=13 min=0.2485 mid=0.2486 max=0.2491 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[703s] Generation 15: replaced=9 min=0.2485 mid=0.2486 max=0.2491 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[736s] Generation 16: replaced=6 min=0.2485 mid=0.2486 max=0.2491 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[769s] Generation 17: replaced=7 min=0.2485 mid=0.2486 max=0.2490 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[799s] Generation 18: replaced=5 min=0.2485 mid=0.2486 max=0.2490 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[827s] Generation 19: replaced=5 min=0.2485 mid=0.2486 max=0.2488 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat')
[827s] Autotuning complete in 827.2s after searching 1517 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=6, indexing='tensor_descriptor', pid_type='flat'))

 94%|█████████▍| 15/16 [2:36:21<12:07, 727.42s/it]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_exp
INFO:tritonbench.utils.triton_op:Took 0.10ms to get benchmark function for triton_exp
INFO:tritonbench.utils.triton_op:Took 1.93ms to get benchmark function for helion_vector_exp
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 2 outliers from 272 samples
Removed 2 outliers from 163 samples
[61s] Timeout after 60s compiling Config(block_sizes=[262144], range_unroll_factors=[3], range_num_stages=[0], range_multi_buffers=[False], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='persistent_interleaved')
[68s] Timeout after 60s compiling Config(block_sizes=[65536], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=1, num_stages=6, indexing='block_ptr', pid_type='persistent_blocked')
[70s] Timeout after 60s compiling Config(block_sizes=[131072], range_unroll_factors=[3], range_num_stages=[0], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='persistent_blocked')
[71s] Timeout after 60s compiling Config(block_sizes=[524288], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[False], num_warps=8, num_stages=8, indexing='tensor_descriptor', pid_type='persistent_blocked')
[86s] Initial population: failed=6 min=0.4900 mid=0.9627 max=183.8546 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[125s] Generation 2: replaced=16 min=0.4900 mid=0.5141 max=0.7279 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[172s] Generation 3: replaced=17 min=0.4900 mid=0.5087 max=0.6577 best=Config(block_sizes=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=8, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[223s] Generation 4: replaced=11 min=0.4895 mid=0.4987 max=0.5694 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[254s] Generation 5: replaced=14 min=0.4895 mid=0.4974 max=0.5347 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[285s] Generation 6: replaced=16 min=0.4895 mid=0.4955 max=0.5105 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[316s] Generation 7: replaced=15 min=0.4895 mid=0.4932 max=0.5004 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[346s] Generation 8: replaced=19 min=0.4894 mid=0.4919 max=0.5004 best=Config(block_sizes=[512], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[376s] Generation 9: replaced=11 min=0.4893 mid=0.4917 max=0.5004 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat')
[404s] Generation 10: replaced=9 min=0.4893 mid=0.4917 max=0.5004 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat')
[432s] Generation 11: replaced=10 min=0.4893 mid=0.4901 max=0.5004 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat')
[464s] Generation 12: replaced=10 min=0.4893 mid=0.4899 max=0.4931 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat')
[499s] Generation 13: replaced=17 min=0.4893 mid=0.4897 max=0.4924 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat')
[535s] Generation 14: replaced=12 min=0.4893 mid=0.4897 max=0.4917 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=2, indexing='pointer', pid_type='flat')
[567s] Generation 15: replaced=11 min=0.4892 mid=0.4895 max=0.4903 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[597s] Generation 16: replaced=9 min=0.4892 mid=0.4894 max=0.4902 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[627s] Generation 17: replaced=11 min=0.4892 mid=0.4894 max=0.4898 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[657s] Generation 18: replaced=9 min=0.4892 mid=0.4894 max=0.4898 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[692s] Generation 19: replaced=6 min=0.4892 mid=0.4894 max=0.4897 best=Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='tensor_descriptor', pid_type='flat')
[692s] Autotuning complete in 692.1s after searching 1516 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[512], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=4, indexing='tensor_descriptor', pid_type='flat'))

100%|██████████| 16/16 [2:47:53<00:00, 716.91s/it]100%|██████████| 16/16 [2:47:53<00:00, 629.62s/it]

Benchmark Results:
    x_val    triton_exp-speedup    helion_vector_exp-speedup
---------  --------------------  ---------------------------
     4096              1.06993                      1.09286
     8192              1                            1.02113
    16384              1.00633                      1.01274
    32768              0.920245                     1.00671
    65536              1.00654                      0.956522
   131072              0.918605                     0.940476
   262144              0.936842                     1.0289
   524288              1                            0.968037
  1048576              1                            1.03745
  2097152              0.973684                     0.978836
  4194304              0.998435                     1.11734
  8388608              0.987622                     1.04295
 16777216              1.00387                      1.03131
 33554432              0.998026                     1.00747
 67108864              0.997338                     1.01287
134217728              0.997875                     1.01314
  average              0.988459                     1.0168

============================================================
Kernel: rms_norm
============================================================

Running rms_norm benchmark with Helion implementation...

Removed 5 outliers from 164 samples
  0%|          | 0/3 [00:00<?, ?it/s]INFO:tritonbench.utils.triton_op:Took 0.30ms to get benchmark function for llama_rms
INFO:tritonbench.utils.triton_op:Took 0.34ms to get benchmark function for liger_rms
INFO:tritonbench.utils.triton_op:Took 1.64ms to get benchmark function for inductor_rms
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for helion_rms_norm
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 15 outliers from 634 samples
Removed 4 outliers from 613 samples
[61s] Timeout after 60s compiling Config(block_sizes=[64], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[False], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='persistent_blocked')
[63s] Initial population: failed=70 min=0.0113 mid=0.0416 max=0.3316 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[118s] Generation 2: replaced=3 failed=28 min=0.0113 mid=0.0263 max=0.3316 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[160s] Generation 3: replaced=2 failed=27 min=0.0113 mid=0.0154 max=0.3316 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[208s] Generation 4: replaced=4 failed=24 min=0.0113 mid=0.0172 max=0.3316 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[269s] Timeout after 60s compiling Config(block_sizes=[1024], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[271s] Timeout after 60s compiling Config(block_sizes=[512], reduction_loops=[None], range_unroll_factors=[4], range_num_stages=[1], range_multi_buffers=[True], range_flattens=[True], num_warps=4, num_stages=1, indexing='tensor_descriptor', pid_type='persistent_interleaved')
[336s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[True], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='persistent_blocked')
[337s] Generation 5: replaced=4 failed=23 min=0.0113 mid=0.0153 max=0.3316 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[411s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[4], range_num_stages=[2], range_multi_buffers=[True], range_flattens=[None], num_warps=1, num_stages=1, indexing='pointer', pid_type='persistent_blocked')
[472s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[4], range_multi_buffers=[True], range_flattens=[None], num_warps=1, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[476s] Generation 6: replaced=5 failed=20 min=0.0113 mid=0.0146 max=0.3316 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[493s] Generation 7: replaced=7 failed=15 min=0.0113 mid=0.0149 max=0.0916 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[515s] Generation 8: replaced=11 failed=11 min=0.0113 mid=0.0142 max=0.1009 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[573s] Generation 9: replaced=9 failed=5 min=0.0113 mid=0.0140 max=0.1009 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[609s] Generation 10: replaced=12 failed=4 min=0.0113 mid=0.0133 max=0.0263 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[675s] Timeout after 60s compiling Config(block_sizes=[512], reduction_loops=[None], range_unroll_factors=[1], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[None], num_warps=2, num_stages=2, indexing='block_ptr', pid_type='persistent_interleaved')
[715s] Generation 11: replaced=15 min=0.0113 mid=0.0133 max=0.0212 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[754s] Generation 12: replaced=12 min=0.0113 mid=0.0120 max=0.0178 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[793s] Generation 13: replaced=13 min=0.0112 mid=0.0119 max=0.0150 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[832s] Generation 14: replaced=16 min=0.0112 mid=0.0116 max=0.0136 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[879s] Generation 15: replaced=11 min=0.0112 mid=0.0115 max=0.0136 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[915s] Generation 16: replaced=13 min=0.0112 mid=0.0114 max=0.0132 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=2, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[944s] Generation 17: replaced=8 min=0.0112 mid=0.0114 max=0.0126 best=Config(block_sizes=[4], reduction_loops=[None], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='pointer', pid_type='flat')
[973s] Generation 18: replaced=9 min=0.0112 mid=0.0114 max=0.0124 best=Config(block_sizes=[4], reduction_loops=[None], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='pointer', pid_type='flat')
[1001s] Generation 19: replaced=6 min=0.0112 mid=0.0114 max=0.0124 best=Config(block_sizes=[4], reduction_loops=[None], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='pointer', pid_type='flat')
[1001s] Autotuning complete in 1001.6s after searching 927 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[4], reduction_loops=[None], range_unroll_factors=[0], range_warp_specializes=[], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=5, indexing='pointer', pid_type='flat'))

 33%|███▎      | 1/3 [16:42<33:24, 1002.47s/it]INFO:tritonbench.utils.triton_op:Took 0.33ms to get benchmark function for llama_rms
INFO:tritonbench.utils.triton_op:Took 0.32ms to get benchmark function for liger_rms
INFO:tritonbench.utils.triton_op:Took 1.61ms to get benchmark function for inductor_rms
INFO:tritonbench.utils.triton_op:Took 2.15ms to get benchmark function for helion_rms_norm
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 3 outliers from 578 samples
Removed 4 outliers from 671 samples
Removed 2 outliers from 694 samples
[39s] Initial population: failed=74 min=0.0137 mid=0.4461 max=1.0206 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[51s] Generation 2: replaced=1 failed=33 min=0.0137 mid=0.0744 max=1.0206 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[112s] Timeout after 60s compiling Config(block_sizes=[512], reduction_loops=[None], range_unroll_factors=[1], range_num_stages=[4], range_multi_buffers=[True], range_flattens=[True], num_warps=4, num_stages=6, indexing='block_ptr', pid_type='persistent_blocked')
[175s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[4], range_num_stages=[4], range_multi_buffers=[None], range_flattens=[True], num_warps=2, num_stages=7, indexing='pointer', pid_type='persistent_interleaved')
[238s] Timeout after 60s compiling Config(block_sizes=[128], reduction_loops=[None], range_unroll_factors=[4], range_num_stages=[0], range_multi_buffers=[False], range_flattens=[None], num_warps=2, num_stages=7, indexing='tensor_descriptor', pid_type='persistent_blocked')
[242s] Generation 3: replaced=7 failed=27 min=0.0137 mid=0.0224 max=1.0206 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[316s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[0], range_multi_buffers=[True], range_flattens=[True], num_warps=4, num_stages=6, indexing='tensor_descriptor', pid_type='persistent_blocked')
[316s] Generation 4: replaced=3 failed=25 min=0.0137 mid=0.0224 max=1.0206 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[379s] Timeout after 60s compiling Config(block_sizes=[512], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[None], num_warps=4, num_stages=7, indexing='pointer', pid_type='persistent_blocked')
[466s] Timeout after 60s compiling Config(block_sizes=[32], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[False], num_warps=1, num_stages=5, indexing='block_ptr', pid_type='persistent_interleaved')
[466s] Generation 5: replaced=7 failed=19 min=0.0137 mid=0.0195 max=1.0206 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
Process ForkProcess-73981:
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 42, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 2231, in make_block_ptr
    return _semantic.make_block_ptr(base, shape, strides, offsets, block_shape, order)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/semantic.py", line 1838, in make_block_ptr
    return self.tensor(handle, tl.pointer_type(tl.block_type(base.type.element_ty, block_shape)))
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/language/core.py", line 726, in __init__
    self.numel = validate_block_shape(self.shape)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/_utils.py", line 56, in validate_block_shape
    raise ValueError(f"numel ({numel}) exceeds triton maximum tensor numel ({TRITON_MAX_TENSOR_NUMEL})")
ValueError: numel (2097152) exceeds triton maximum tensor numel (1048576)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/data/users/willfeng/helion/helion/runtime/precompile_shim.py", line 54, in finish_it
    kernel_cache[key] = fn.compile(
                        ^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 339, in compile
    module = src.make_ir(options, codegen_fns, module_map, context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/compiler/compiler.py", line 83, in make_ir
    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
triton.compiler.errors.CompilationError: at 4:21:
def _rms_norm_kernel(x, weight, out, eps, _BLOCK_SIZE_0: tl.constexpr, _RDIM_SIZE_1: tl.constexpr):
    pid_0 = tl.program_id(0)
    offset_0 = pid_0 * _BLOCK_SIZE_0
    x_tile = tl.load(tl.make_block_ptr(x, [2048, 2048], [2048, 1], [offset_0, 0], [_BLOCK_SIZE_0, _RDIM_SIZE_1], [1, 0]), boundary_check=[0, 1], padding_option='zero')
                     ^
[528s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[False], num_warps=2, num_stages=8, indexing='pointer', pid_type='persistent_interleaved')
[603s] Timeout after 60s compiling Config(block_sizes=[128], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=7, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[664s] Generation 6: replaced=6 failed=17 min=0.0137 mid=0.0195 max=1.0206 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[783s] Generation 7: replaced=9 failed=10 min=0.0137 mid=0.0202 max=1.0206 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[870s] Timeout after 60s compiling Config(block_sizes=[128], reduction_loops=[None], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[False], num_warps=4, num_stages=3, indexing='block_ptr', pid_type='persistent_interleaved')
[890s] Generation 8: replaced=8 failed=6 min=0.0137 mid=0.0206 max=0.5896 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[951s] Timeout after 60s compiling Config(block_sizes=[512], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[True], num_warps=4, num_stages=4, indexing='pointer', pid_type='persistent_blocked')
[976s] Generation 9: replaced=6 failed=5 min=0.0137 mid=0.0189 max=0.2701 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1047s] Generation 10: replaced=7 failed=4 min=0.0137 mid=0.0183 max=0.2701 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1091s] Generation 11: replaced=12 min=0.0137 mid=0.0182 max=0.2701 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1153s] Generation 12: replaced=9 min=0.0137 mid=0.0181 max=0.2656 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1200s] Generation 13: replaced=8 min=0.0137 mid=0.0181 max=0.0246 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1237s] Generation 14: replaced=6 min=0.0137 mid=0.0180 max=0.0246 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1271s] Generation 15: replaced=4 min=0.0137 mid=0.0180 max=0.0246 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1311s] Generation 16: replaced=5 min=0.0137 mid=0.0180 max=0.0222 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1355s] Generation 17: replaced=3 min=0.0137 mid=0.0180 max=0.0222 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1391s] Generation 18: replaced=5 min=0.0137 mid=0.0180 max=0.0195 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1426s] Generation 19: replaced=1 min=0.0137 mid=0.0180 max=0.0195 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1426s] Autotuning complete in 1426.7s after searching 961 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

 67%|██████▋   | 2/3 [40:30<20:52, 1252.55s/it]INFO:tritonbench.utils.triton_op:Took 0.38ms to get benchmark function for llama_rms
INFO:tritonbench.utils.triton_op:Took 0.34ms to get benchmark function for liger_rms
INFO:tritonbench.utils.triton_op:Took 1.58ms to get benchmark function for inductor_rms
INFO:tritonbench.utils.triton_op:Took 2.58ms to get benchmark function for helion_rms_norm
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 5 outliers from 665 samples
Removed 1 outliers from 407 samples
Removed 10 outliers from 616 samples
Removed 7 outliers from 647 samples
[60s] Timeout after 60s compiling Config(block_sizes=[128], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=2, num_stages=6, indexing='tensor_descriptor', pid_type='flat', range_warp_specializes=[])
[61s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[None], num_warps=16, num_stages=4, indexing='block_ptr', pid_type='persistent_interleaved')
[61s] Timeout after 61s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[2], range_num_stages=[2], range_multi_buffers=[False], range_flattens=[True], num_warps=16, num_stages=1, indexing='pointer', pid_type='persistent_interleaved')
[61s] Initial population: failed=79 min=0.0291 mid=0.0291 max=0.0291 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[76s] Generation 2: replaced=3 failed=36 min=0.0291 mid=0.0353 max=0.0402 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[145s] Generation 3: replaced=4 failed=32 min=0.0291 mid=0.0353 max=0.0555 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[160s] Generation 4: replaced=2 failed=30 min=0.0291 mid=0.0402 max=0.1770 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[172s] Generation 5: replaced=6 failed=24 min=0.0291 mid=0.0383 max=0.1770 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[238s] Timeout after 60s compiling Config(block_sizes=[32], reduction_loops=[None], range_unroll_factors=[2], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='persistent_blocked')
[305s] Timeout after 60s compiling Config(block_sizes=[16], reduction_loops=[None], range_unroll_factors=[4], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=1, num_stages=4, indexing='block_ptr', pid_type='persistent_blocked')
[307s] Generation 6: replaced=4 failed=21 min=0.0291 mid=0.0383 max=0.0599 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[323s] Generation 7: replaced=7 failed=19 min=0.0291 mid=0.0339 max=0.0599 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[387s] Timeout after 60s compiling Config(block_sizes=[256], reduction_loops=[None], range_unroll_factors=[4], range_num_stages=[3], range_multi_buffers=[None], range_flattens=[None], num_warps=32, num_stages=8, indexing='block_ptr', pid_type='persistent_interleaved')
[411s] Generation 8: replaced=15 failed=11 min=0.0291 mid=0.0320 max=0.0484 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[532s] Generation 9: replaced=7 failed=5 min=0.0291 mid=0.0336 max=0.0507 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[595s] Timeout after 60s compiling Config(block_sizes=[128], reduction_loops=[None], range_unroll_factors=[3], range_num_stages=[3], range_multi_buffers=[True], range_flattens=[False], num_warps=8, num_stages=3, indexing='block_ptr', pid_type='persistent_interleaved')
[634s] Generation 10: replaced=9 failed=2 min=0.0291 mid=0.0343 max=0.1997 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[714s] Timeout after 60s compiling Config(block_sizes=[32], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[3], range_multi_buffers=[False], range_flattens=[None], num_warps=1, num_stages=1, indexing='block_ptr', pid_type='persistent_blocked')
[753s] Generation 11: replaced=5 failed=1 min=0.0291 mid=0.0343 max=0.0459 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[802s] Generation 12: replaced=6 min=0.0291 mid=0.0343 max=0.5603 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[863s] Generation 13: replaced=6 min=0.0291 mid=0.0343 max=0.0384 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[914s] Generation 14: replaced=1 min=0.0291 mid=0.0343 max=0.0384 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1021s] Generation 15: replaced=2 min=0.0291 mid=0.0343 max=0.0374 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1074s] Generation 16: replaced=6 min=0.0291 mid=0.0343 max=0.0365 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1136s] Generation 17: replaced=6 min=0.0291 mid=0.0343 max=0.0361 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1185s] Generation 18: replaced=0 min=0.0291 mid=0.0343 max=0.0361 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1239s] Generation 19: replaced=3 min=0.0291 mid=0.0343 max=0.0361 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[])
[1239s] Autotuning complete in 1240.0s after searching 933 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=3, indexing='pointer', pid_type='flat', range_warp_specializes=[]))

100%|██████████| 3/3 [1:01:10<00:00, 1247.22s/it]100%|██████████| 3/3 [1:01:10<00:00, 1223.65s/it]

Benchmark Results:
      (M, H)    liger_rms-speedup    inductor_rms-speedup    helion_rms_norm-speedup
------------  -------------------  ----------------------  -------------------------
(2048, 1024)              3.38965                 3.07921                    2.76444
(2048, 2048)              3.00639                 3.09539                    2.74745
(2048, 4096)              3.78938                 3.88376                    3.63872
     average              3.39514                 3.35279                    3.0502

============================================================
Kernel: sum
============================================================

Running sum benchmark with Helion implementation...

Removed 5 outliers from 530 samples
  0%|          | 0/14 [00:00<?, ?it/s]INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_sum
INFO:tritonbench.utils.triton_op:Took 0.03ms to get benchmark function for triton_sum
INFO:tritonbench.utils.triton_op:Took 0.04ms to get benchmark function for helion_sum
[0s] Starting DifferentialEvolutionSearch with population=40, generations=20, crossover_rate=0.8
Removed 1 outliers from 702 samples
[33s] Initial population: min=0.0045 mid=0.0064 max=0.0275 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[90s] Generation 2: replaced=20 min=0.0045 mid=0.0049 max=0.0062 best=Config(block_sizes=[1], reduction_loops=[None], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=8, num_stages=1, indexing='block_ptr', pid_type='flat', range_warp_specializes=[])
[110s] Timeout after 1s compiling Config(block_sizes=[1], reduction_loops=[256], range_unroll_factors=[0], range_num_stages=[0], range_multi_buffers=[None], range_flattens=[None], num_warps=4, num_stages=1, indexing='pointer', pid_type='flat', range_warp_specializes=[])
  0%|          | 0/14 [01:51<?, ?it/s]
WARNING:tritonbench.utils.triton_op:Caught exception, terminating early with partial results
Traceback (most recent call last):
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/utils/triton_op.py", line 890, in run
    y_vals: Dict[str, BenchmarkOperatorMetrics] = functools.reduce(
                                                  ^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/utils/triton_op.py", line 878, in _reduce_benchmarks
    acc[bm_name] = self._do_bench(
                   ^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/utils/triton_op.py", line 1179, in _do_bench
    metrics.latency = do_bench_wrapper(
                      ^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/components/do_bench/run.py", line 202, in do_bench_wrapper
    times=triton.testing.do_bench(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/testing.py", line 149, in do_bench
    fn()
  File "/data/users/willfeng/helion/benchmarks/run.py", line 300, in _inner
    result = kernel_func(*args)
             ^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/examples/sum.py", line 27, in sum_tritonbench
    result = sum_kernel(x_2d)
             ^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/runtime/kernel.py", line 252, in __call__
    return self.bind(args)(*args)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/runtime/kernel.py", line 535, in __call__
    self.autotune(args)
  File "/data/users/willfeng/helion/helion/runtime/kernel.py", line 447, in autotune
    ).autotune()
      ^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 237, in autotune
    best = self._autotune()
           ^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/differential_evolution.py", line 99, in _autotune
    replaced = self.evolve_population()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/differential_evolution.py", line 84, in evolve_population
    candidate = self.benchmark_flat(self.mutate(i))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 336, in benchmark_flat
    return PopulationMember(self.benchmark(config), flat_values, config)
                            ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 94, in benchmark
    if self.start_precompile_and_check_for_hangs(config, fn)():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 460, in __call__
    process.join(self.seconds_left())
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/connection.py", line 1135, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/miniconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Traceback (most recent call last):
  File "/data/users/willfeng/helion/benchmarks/run.py", line 410, in <module>
    main()
  File "/data/users/willfeng/helion/benchmarks/run.py", line 406, in main
    run_kernel(kernel_name, tritonbench_args.copy())
  File "/data/users/willfeng/helion/benchmarks/run.py", line 339, in run_kernel
    op.run(warmup=warmup, rep=rep)
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/utils/triton_op.py", line 890, in run
    y_vals: Dict[str, BenchmarkOperatorMetrics] = functools.reduce(
                                                  ^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/utils/triton_op.py", line 878, in _reduce_benchmarks
    acc[bm_name] = self._do_bench(
                   ^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/utils/triton_op.py", line 1179, in _do_bench
    metrics.latency = do_bench_wrapper(
                      ^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/benchmarks/tritonbench/tritonbench/components/do_bench/run.py", line 202, in do_bench_wrapper
    times=triton.testing.do_bench(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/pytorch-nightly/triton/testing.py", line 149, in do_bench
    fn()
  File "/data/users/willfeng/helion/benchmarks/run.py", line 300, in _inner
    result = kernel_func(*args)
             ^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/examples/sum.py", line 27, in sum_tritonbench
    result = sum_kernel(x_2d)
             ^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/runtime/kernel.py", line 252, in __call__
    return self.bind(args)(*args)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/runtime/kernel.py", line 535, in __call__
    self.autotune(args)
  File "/data/users/willfeng/helion/helion/runtime/kernel.py", line 447, in autotune
    ).autotune()
      ^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 237, in autotune
    best = self._autotune()
           ^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/differential_evolution.py", line 99, in _autotune
    replaced = self.evolve_population()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/differential_evolution.py", line 84, in evolve_population
    candidate = self.benchmark_flat(self.mutate(i))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 336, in benchmark_flat
    return PopulationMember(self.benchmark(config), flat_values, config)
                            ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 94, in benchmark
    if self.start_precompile_and_check_for_hangs(config, fn)():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/users/willfeng/helion/helion/autotuner/base_search.py", line 460, in __call__
    process.join(self.seconds_left())
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/miniconda3/lib/python3.12/multiprocessing/connection.py", line 1135, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/willfeng/local/miniconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <function shutdown_compile_workers at 0x7f98041e80e0>
Traceback (most recent call last):
  File "/home/willfeng/local/pytorch-nightly/torch/_inductor/async_compile.py", line 145, in shutdown_compile_workers
    pool.shutdown()
  File "/home/willfeng/local/pytorch-nightly/torch/_inductor/compile_worker/subproc_pool.py", line 262, in shutdown
    self.process.wait(300)
  File "/home/willfeng/local/miniconda3/lib/python3.12/subprocess.py", line 1277, in wait
    self._wait(timeout=sigint_timeout)
  File "/home/willfeng/local/miniconda3/lib/python3.12/subprocess.py", line 2045, in _wait
    time.sleep(delay)
KeyboardInterrupt: 
